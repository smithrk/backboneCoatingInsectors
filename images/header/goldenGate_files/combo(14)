YUI.add("flickr-creations-fetcher",function(e,t){"use strict";function n(t){var n={extras:e.APIHelper.request.getRebootPhotoExtras()};return n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=t[7],c=t[8],h=[],p=[],d=[];return r&&r.stat==="ok"&&(h=Object.keys(r.wallart_ids).map(function(e){return r.wallart_ids[e]}),e.Array.each(h,function(t,r){if(t.photoSource===2)return;var i,s,u,h,d=[],v=!1,m,g,y,b={};s=a.exists(n.id)?a.proxy(n.id):a.add({id:t.owner}),t.photo.id?(b={photos:[t.photo],personModelRegistry:a,photoModelRegistry:f,photoEngagementModelRegistry:l,photoStatsModelRegistry:c},t.photo.ownerId&&(b.ownerID=t.photo.ownerId),u=e.APIHelper.response.parsePhotos(b)[0]):v=!0,t.orders&&typeof t.orders=="object"&&(h=Object.keys(t.orders).map(function(e){return t.orders[e]}),e.Array.each(h,function(e){d.push({orderId:e.orderId,orderStatus:e.order.statusOrder,dateCreate:e.dateCreate,dateUpdate:e.dateUpdate})})),t.skuId.substr(-2)==="CC"?(m=t.skuId.slice(0,-3),g=!0):t.skuId.substr(-2)==="MK"?(m=t.skuId.slice(0,-3),y=!0):m=t.skuId,i=o.exists(t.wallartId)?o.proxy(t.wallartId):o.add({id:t.wallartId,owner:s,photo:u,photoDeleted:v,skuId:m,isCC:g,isMK:y,orientation:t.orientation,price:t.price,cropW:t.photo.cropW,cropH:t.photo.cropH,cropX:t.photo.cropX,cropY:t.photo.cropY,isEditable:t.isEditable,isLowQuality:t.isLowQuality,created:t.dateCreate,updated:t.dateUpdate,orders:d,photoSource:t.photoSource}),p.push(i)})),i&&i.stat==="ok"&&e.Array.each(i.books.book,function(t,r){var i,s=!1,o,h;o=a.exists(n.id)?a.proxy(n.id):a.add({id:t.owner}),t.coverPhoto.id?h=e.APIHelper.response.parsePhotos({photos:[t.coverPhoto],personModelRegistry:a,photoModelRegistry:f,photoEngagementModelRegistry:l,photoStatsModelRegistry:c})[0]:s=!0,i=u.exists(t.id)?u.proxy(t.id):u.add({id:t.id,title:t.title,owner:o,coverPhoto:h,coverPhotoDeleted:s,totalPages:t.countPages,created:t.dateCreate,updated:t.dateUpdate,cropW:t.coverPhoto.cropW/100,cropH:t.coverPhoto.cropH/100,cropX:t.coverPhoto.cropX/100,cropY:t.coverPhoto.cropY/100}),d.push(i)}),s.exists(n.id)||s.add({id:n.id,wallarts:p,books:d}),{wallarts:p,books:d}}function i(n,r){var i=this,s=this._processParams(n);return e.Promise.all([r.callAPI("flickr.products.wallart.getList",s,!0),r.callAPI("flickr.products.books.getList",s,!0),r.getModelRegistry("creations-models"),r.getModelRegistry("wallart-models"),r.getModelRegistry("basic-book-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-creations"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["creations-models","wallart-models","basic-book-models","person-models","photo-models","photo-engagement-models","photo-stats-models"]});
YUI.add("creations-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-creations"].run(t,this.appContext)}},removeCreations:function(t,n){var r=this;n.wallarts&&e.Array.each(n.wallarts,function(e,n){r.getValue(t,"wallarts").remove(e)}),n.books&&e.Array.each(n.books,function(e,n){r.getValue(t,"books").remove(e)})},appendCreations:function(t,n){var r=this;n.wallarts&&e.Array.each(n.wallarts,function(e,n){r.getValue(t,"wallarts").unshift(e)})},attributes:{wallarts:{isCollection:!0},books:{isCollection:!0}}})},"@VERSION@",{requires:["flickr-promise","model-proxy","flickr-model-registry","flickr-creations-fetcher"],optional:["wallart-models","basic-book-models"]});
YUI.add("flickr-products-wallart-create-creator",function(e,t){"use strict";function n(e){var t={};return e=e||{},t.photo_id=e.photoId,t.sku_id=e.skuId,t}function r(e,t,n){var r=e[0],i=e[1],s=e[2],o=e[3],u=t.nsid,a,f,l,c,h=!1,p=!1,d=e[4],v,m;return r?(a=r.wallart,l=s.exists(u)?s.proxy(u):s.add({id:u}),f=o.exists(t.photoId)?o.proxy(t.photoId):o.add({id:t.photoId}),a.skuId.substr(-2)==="CC"?(c=a.skuId.slice(0,-3),h=!0):a.skuId.substr(-2)==="MK"?(c=a.skuId.slice(0,-3),p=!0):c=a.skuId,i.exists(a.wallartId)?(i.setValues(a.wallartId,{owner:l,photo:f,skuId:c,isCC:h,isMK:p,orientation:a.orientation,photoSource:a.photoSource}),m=i.proxy(a.wallartId)):m=i.add({id:a.wallartId,owner:l,photo:f,skuId:c,isCC:h,isMK:p,orientation:a.orientation,created:a.dateCreate,photoSource:a.photoSource}),d.exists(u)&&(v=d.proxy(u),v.appendCreations({wallarts:[i.proxy(a.wallartId)]}))):(n.warn("flickr-products-wallart-create-creator: No API response?"),m=this),m}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.products.wallart.create",this._processParams(n)),r.getModelRegistry("wallart-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("creations-models")]).then(function(e){return i._processResponse(e,n,r)},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-products-wallart-create"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","wallart-models"],optional:["person-models","photo-models","creations-models"]});
YUI.add("flickr-products-wallart-editWallart-updater",function(e,t){"use strict";function n(e,t,n){var r=e.response,i=e.wallartModelRegistry;i.exists(t)&&i.setValue(t,"price",r.wallart.price);if(this.pendingUpdate)return this.pendingUpdate=!1,this.startNextUpdate(t,n)}function r(e,t){return t.getModel("wallart-models",e).then(function(e){var t,n,r,i,s;return n=e.getValue("photo"),i=e.getValue("isCC"),s=e.getValue("isMK"),r=e.getValue("skuId"),i===!0?r+="_CC":s===!0&&(r+="_MK"),t={wallart_id:e.id,photo:{id:n.getValue("id"),owner:n.getValue("owner").getValue("id"),crop_x:e.getValue("cropX"),crop_y:e.getValue("cropY"),crop_h:e.getValue("cropH"),crop_w:e.getValue("cropW")},sku_id:r,orientation:e.getValue("orientation"),is_low_quality:e.getValue("isLowQuality")},{wallart:JSON.stringify(t)}})}function i(n,r){var i=this;return this.serialize(n,r).then(function(s){return(new e.FlickrPromise({response:r.callAPI("flickr.products.wallart.update",s),wallartModelRegistry:r.getModelRegistry("wallart-models")})).then(function(e){return i.processResponse(e,n,r)},function(e){throw i.pendingUpdate&&(i.pendingUpdate=!1),e}).then(null,e.FetcherErrorLogger(t))})}function s(){return this.updateInFlight=null,!0}function o(e,t){return this.updateInFlight=this.callAPI(e,t).then(this.clearUpdateInFlight.bind(this),this.clearUpdateInFlight.bind(this)),this.updateInFlight}function u(e,t){return this.pendingUpdate=null,this.startUpdate(e,t)}function a(e,t){return this.pendingUpdate?this.updateInFlight:this.updateInFlight?(this.pendingUpdate=!0,this.updateInFlight):this.startUpdate(e,t)}e.namespace("ModelUpdaters")["flickr-products-wallart-editWallart"]={run:a,serialize:r,callAPI:i,clearUpdateInFlight:s,startUpdate:o,processResponse:n,startNextUpdate:u}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("wallart-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-products-wallart"].run(t,this.appContext)},create:function(t){return e.ModelCreators["flickr-products-wallart-create"].run(t,this.appContext)},update:function(t,n){return e.ModelUpdaters["flickr-products-wallart-editWallart"].run(t,this.appContext)}},attributes:{owner:{isModel:!0},photo:{isModel:!0},photoDeleted:{defaultFn:function(){return!1}},isCC:{defaultFn:function(){return!1}},isMK:{defaultFn:function(){return!1}},photoSource:{},skuId:{},orientation:{},price:{},cropW:{setter:function(e){return Math.abs(parseFloat(e,10))},defaultFn:function(){return 0}},cropH:{setter:function(e){return Math.abs(parseFloat(e,10))},defaultFn:function(){return 0}},cropX:{setter:function(e){return Math.abs(parseFloat(e,10))},defaultFn:function(){return 0}},cropY:{setter:function(e){return Math.abs(parseFloat(e,10))},defaultFn:function(){return 0}},isLowQuality:{defaultFn:function(){return 0}},isEditable:{defaultFn:function(){return!0}},isDeleted:{defaultFn:function(){return!1}},invalidForPrintReason:{},isInvalidForPrint:{},created:{getter:function(e){return parseInt(e,10)}},updated:{getter:function(e){return parseInt(e,10)}},orders:{}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-products-wallart-fetcher","flickr-products-wallart-create-creator","flickr-products-wallart-editWallart-updater"]});
YUI.add("flickr-products-wallart-fetcher",function(e,t){"use strict";function n(t){var n={wallart_id:t.id,return_deleted:1,extras:e.APIHelper.request.getRebootPhotoExtras()};return n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=r.wallart,l,c,h,p,d=!1,v=!1,m={};if(f)return h=s.exists(f.owner)?s.proxy(f.owner):s.add({id:f.owner}),m={photos:[f.photo],personModelRegistry:s,photoModelRegistry:o,photoEngagementModelRegistry:u,photoStatsModelRegistry:a},f.photo.ownerId&&(m.ownerID=f.photo.ownerId),c=e.APIHelper.response.parsePhotos(m)[0],f.skuId.substr(-2)==="CC"?(p=f.skuId.slice(0,-3),d=!0):f.skuId.substr(-2)==="MK"?(p=f.skuId.slice(0,-3),v=!0):p=f.skuId,l={id:f.wallartId,owner:h,photo:c,skuId:p,isCC:d,isMK:v,orientation:f.orientation,price:f.price,cropW:f.photo.cropW,cropH:f.photo.cropH,cropX:f.photo.cropX,cropY:f.photo.cropY,isEditable:f.isEditable,isDeleted:f.isDeleted,isLowQuality:f.isLowQuality,photoSource:f.photoSource,created:f.dateCreate},i.exists(l.id)?i.setValues(l.id,l):i.add(l),l}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.products.wallart.getDetails",this._processParams(n)),r.getModelRegistry("wallart-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-products-wallart"]={run:i,_processResponse:r,_processParams:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["wallart-models","photo-models","person-models","photo-engagement-models","photo-stats-models"]});
YUI.add("photo-engagement-view",function(e,t){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.photoId=e.photoId,this.nsid=e.nsid,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},subviewConfig:{"fave-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,hideWhoFaved:!0},"photo-well-scrappy-edit-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"fluid-share-photo-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!this.appContext.flipper.isFlipped("rebootify-sharing")}}},loadState:function(){var e=this;return this.appContext.getModel("photo-models",e.photoId).then(function(t){e.set("photo",t)})},buildContainer:function(){var e,t={viewerIsOwner:this.get("photo").getValue("owner").getValue("isMe"),"photo-well-scrappy-edit-view":this.subviews["photo-well-scrappy-edit-view"].get("container"),"fave-view":this.subviews["fave-view"].get("container"),isVideo:this.get("photo").getValue("isVideo"),canCreateWallart:this.canCreateWallart(),isWallartLowQuality:this.isWallartLowQuality(),photoId:this.get("photo").getValue("id"),shareView:this.subviews["fluid-share-photo-view"]?this.subviews["fluid-share-photo-view"].get("container"):""};return e=this.templates("photo-engagement")(t),this.setContainerHTML(e),t.canCreateWallart&&this.get("container").addClass("has-wallart"),this},buildErrorContainer:function(){this.setContainerHTML("")},activate:function(){var e=this.get("container");return this.downloadMenuSetup(),this.registerEventHandler(e.all(".sizes li a.download-image-size").on("click",this.handleDownloadItemClick,this)),this.attachKeyEvent("down:68",this.handleDownloadMenuButtonClick.bind(this)),this.registerEventHandler(e.delegate("click",this.handleDownloadMenuButtonClick.bind(this),".download a")),this.registerEventHandler(e.delegate("click",this.handleShareClicked.bind(this),".share a")),this.registerEventHandler(e.delegate("click",this.createWallartClick.bind(this),".wallart a")),this.registerEventHandler(this.get("photo").on("valuesChanged",function(e){e.isMarketplacePrintable&&e.isMarketplacePrintable.newVal===!0&&(this.buildContainer(),this.downloadMenuSetup(),this.get("container").all(".sizes li a.download-image-size").on("click",this.handleDownloadItemClick,this))}.bind(this))),this},canCreateWallart:function(){var e=!1,t,n=this.appContext.getViewer(),r,i,s,o,u,a;return this.appContext.flipper.isFlipped("wallart")&&this.appContext.flipper.isFlipped("wallart-on-engagement")&&(t=this.get("photo"),t&&n&&(i=!1,r=t.getValue("owner").getValue("isMe"),s=t.getValue("isMarketplacePrintable"),a=t.getValue("safetyLevel")===0,o=!t.getValue("isVideo"),u=n.intl==="us"||this.appContext.flipper.isFlipped("intl-shipping"),this.appContext.flipper.isFlipped("creative-commons-wallart")?r?this.appContext.getViewer().signedIn&&o&&u&&(e=!0):i?this.appContext.getViewer().signedIn&&o&&u&&a&&(e=!0):s&&this.appContext.getViewer().signedIn&&o&&u&&a&&(e=!0):this.appContext.getViewer().signedIn&&r&&o&&u&&(e=!0))),e},isWallartLowQuality:function(){var t=this.get("photo");return this.wallartHelper||(this.wallartHelper=new e.WallartHelper),this.wallartHelper.isPhotoWallartable(t).skus.length===0?!0:!1},createWallartClick:function(n){var r=this,i="/create/wallart/",s=this.get("photo"),o;n.halt(),e.rapidTracker.beacon(t,"createWallartClick");if(s.getValue("hasInvalidColorspaceForPrint"))return this.handleLacksWallartability("COLORSPACE");this.wallartHelper||(this.wallartHelper=new e.WallartHelper(this.appContext));if(this.wallartHelper.isPhotoWallartable(s).skus.length===0)return this.handleLacksWallartability("LOW_QUALITY");this.appContext.getModelRegistry("wallart-models").then(function(t){t.remoteCreate({nsid:r.appContext.getViewer().nsid,photoId:s.getValue("id")}).then(function(t){i+=t.getValue("id")+"/edit",YUI.Env.isServer||(!r.appContext.secure&&window.location.host===e.config.flickr.url.host?e.config.win.location.href=i:r.appContext.flapp.navigate(i))},function(t){o=new e.Views.FluidModal({appContext:r.appContext,darkOverlay:!0,dismissOnOverlayClick:!0,actionButtonLabel:"Okay",title:"Uh oh",message:"There was a problem creating your wall art. Please try again later."}),o.show(),r.appContext.warn("uh oh spaghettios")})})},handleLacksWallartability:function(t){var n,r;t==="LOW_QUALITY"?r="Looks like this photo doesn't meet the minimum requirements to get printed. Please choose a photo that's at least 975 &times; 825 pixels. Learn more about <a href='http://help.yahoo.com/kb/index?page=content&y=PROD_FLICKR&locale=en_US&id=SLN22567'>requirements</a> for print products.":t==="COLORSPACE"&&(r="Sorry, we cannot print photos with a CMYK or ProPhoto RGB colorspace. We recommend photos with an sRGB color space. <a href='https://help.yahoo.com/kb/flickr/creations-faq-sln22216.html?impressions=true#cont33'>Learn more</a>."),n=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,showCancelButton:!1,showCancelX:!0,title:"Try a different photo",message:r,classList:"lacks-wallartability"}),n.show()},handleShareClicked:function(n){n.preventDefault();var r=this,i=this.subviews["share-view"];e.rapidTracker.beacon(t,"shareActionBarButtonClick");if(i)return i.fire("subviewViewEvent","openShareMenu",{}),i[i.isVisible()?"hide":"show"]();this.appContext.getView("share-view",{photoId:this._params.photoId,anchorTo:r.get("container").one(".share"),arrow:!0,dropUp:!0,parent:this}).then(function(e){r.subviews["share-view"]=e,e.switchToLoading(),e.initialize().then(function(){e.show()})}).then(null,function(e){r.appContext.warn(e)})},downloadMenuSetup:function(t){var n=this.get("container"),r=e.clone(this.get("photo").toJSON()),i=this,s,o=[],u,a=this.get("photo").getValue("engagement").getValue("canDownload"),f=this.appContext.flipper.isFlipped("download-dialog-enabled"),l=!1;r.sizes.q&&(r.sizes.q.label=this.intlMessage({intlName:"photo-page-scrappy.SQUARE"
}),o.push(r.sizes.q)),r.sizes.s&&(r.sizes.s.label=this.intlMessage({intlName:"photo-page-scrappy.SMALL"}),o.push(r.sizes.s)),r.sizes.z&&(r.sizes.z.label=this.intlMessage({intlName:"photo-page-scrappy.MEDIUM"}),o.push(r.sizes.z)),r.sizes.k?(r.sizes.k.label=this.intlMessage({intlName:"photo-page-scrappy.LARGE"}),o.push(r.sizes.k)):r.sizes.h?(r.sizes.h.label=this.intlMessage({intlName:"photo-page-scrappy.LARGE"}),o.push(r.sizes.h)):r.sizes.l&&(r.sizes.l.label=this.intlMessage({intlName:"photo-page-scrappy.LARGE"}),o.push(r.sizes.l)),r.sizes.o&&(r.sizes.o.label=this.intlMessage({intlName:"photo-page-scrappy.ORIGINAL"}),o.push(r.sizes.o));for(u=0;u<o.length;u++)o[u].url=o[u].displayUrl.replace(/^(.+)(\..+)$/,"$1_d$2");a&&f&&(l=!0),s=this.templates("scrappy-download-menu")({photo:r,sizes:o,showDownloadSizes:l}),this.downloadMenu=e.Views.dialog.getNewInstance("dialog-tooltip",{content:s,anchorTo:n.one(".download"),dropUp:!0,parent:this,positioning:!1,rootEl:n}),this.downloadMenu.render(),this.downloadMenu.on("toggle",function(e){e&&e.details&&e.details.length>0&&(e.details[0]?i.fire("subviewViewEvent","make in view",n):i.fire("subviewViewEvent","close in view"))})},handleDownloadMenuButtonClick:function(n){var r=this.get("photo").getValue("isVideo");e.rapidTracker.beacon(t,"downloadDialogClick"),r||(n.preventDefault(),this.downloadMenu.toggle())},handleDownloadItemClick:function(n){n.preventDefault();var r;r=n.currentTarget.getAttribute("href"),document.location=r,e.rapidTracker.beacon(t,"photoDownloadClick"),this.downloadMenu.hide()}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-engagement","hermes-template-download-dialog","hermes-template-scrappy-download-menu","wallart-helper","photo-engagement-css","fluid-share-photo-view"],optional:["photo-models","wallart-models"],langBundles:["common","photo-page-scrappy"]});
YUI.add("hermes-template-photo-page-lightbox",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression;return u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["photo-well-view"],u):a.call(t,"outlet",t["photo-well-view"],u)))+"\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-page-lightbox",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-photo-well",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return" no-click"}function d(e,t){return" is-hidden"}function v(e,t){return" is-video"}function m(e,t){var r;return(r=n["prev-url"])?r=r.call(e,{hash:{},data:t}):(r=e["prev-url"],r=typeof r===f?r.apply(e):r),l(r)}function g(e,t){return"#"}function y(e,t){var r;return(r=n["next-url"])?r=r.call(e,{hash:{},data:t}):(r=e["next-url"],r=typeof r===f?r.apply(e):r),l(r)}function b(e,t){var r="",i,s;r+="\n	",i=n["if"].call(e,e["opt-out-enabled"],{hash:{},inverse:c.noop,fn:c.program(14,w,t),data:t});if(i||i===0)r+=i;return r+="\n\n",s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["photo-sidebar-toggle-view"],s):h.call(e,"outlet",e["photo-sidebar-toggle-view"],s)))+"\n",s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["photo-title-desc-overlay-view"],s):h.call(e,"outlet",e["photo-title-desc-overlay-view"],s)))+"\n",s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["photo-sidebar-actions-view"],s):h.call(e,"outlet",e["photo-sidebar-actions-view"],s)))+"\n",s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["attribution-view"],s):h.call(e,"outlet",e["attribution-view"],s)))+"\n",s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["people-notes-view"],s):h.call(e,"outlet",e["people-notes-view"],s)))+"\n\n",r}function w(e,t){return'\n	<div class="feedback-widget">\n		<button class="ui-button ui-button-cta ui-button-transparent"><span>Opt-out &amp; Feedback</span></button>\n	</div>\n	'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<a class="navigate-target navigate-prev',o=n["if"].call(t,t["prev-is-not-clickable"],{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,t["is-hidden"],{hash:{},inverse:c.noop,fn:c.program(3,d,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,t["is-video"],{hash:{},inverse:c.noop,fn:c.program(5,v,i),data:i});if(o||o===0)s+=o;s+='" href="',o=n["if"].call(t,t["prev-url"],{hash:{},inverse:c.program(9,g,i),fn:c.program(7,m,i),data:i});if(o||o===0)s+=o;s+='" data-track="prevPhotoButtonClick" data-action="ad"><span class="hide-text">&rarr;</span></a>\n<a class="navigate-target-arrow-only navigate-target navigate-prev',o=n["if"].call(t,t["prev-is-not-clickable"],{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,t["is-hidden"],{hash:{},inverse:c.noop,fn:c.program(3,d,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,t["is-video"],{hash:{},inverse:c.noop,fn:c.program(5,v,i),data:i});if(o||o===0)s+=o;s+='" href="',o=n["if"].call(t,t["prev-url"],{hash:{},inverse:c.program(9,g,i),fn:c.program(7,m,i),data:i});if(o||o===0)s+=o;s+='" data-track="prevPhotoButtonClick" data-action="ad"><span class="hide-text">&larr;</span></a>\n\n',a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["photo-well-media-view"],a):h.call(t,"outlet",t["photo-well-media-view"],a)))+'\n\n<a class="navigate-target navigate-next',u=n["if"].call(t,t["next-is-not-clickable"],{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;u=n["if"].call(t,t["is-hidden"],{hash:{},inverse:c.noop,fn:c.program(3,d,i),data:i});if(u||u===0)s+=u;u=n["if"].call(t,t["is-video"],{hash:{},inverse:c.noop,fn:c.program(5,v,i),data:i});if(u||u===0)s+=u;s+='" href="',u=n["if"].call(t,t["next-url"],{hash:{},inverse:c.program(9,g,i),fn:c.program(11,y,i),data:i});if(u||u===0)s+=u;s+='" data-track="nextPhotoButtonClick" data-action="ad"><span class="hide-text">&rarr;</span></a>\n<a class="navigate-target-arrow-only navigate-target navigate-next',u=n["if"].call(t,t["next-is-not-clickable"],{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;u=n["if"].call(t,t["is-hidden"],{hash:{},inverse:c.noop,fn:c.program(3,d,i),data:i});if(u||u===0)s+=u;u=n["if"].call(t,t["is-video"],{hash:{},inverse:c.noop,fn:c.program(5,v,i),data:i});if(u||u===0)s+=u;s+='" href="',u=n["if"].call(t,t["next-url"],{hash:{},inverse:c.program(9,g,i),fn:c.program(11,y,i),data:i});if(u||u===0)s+=u;s+='" data-track="nextPhotoButtonClick" data-action="ad"><span class="hide-text">&rarr;</span></a>\n\n',u=n.unless.call(t,t["is-ad"],{hash:{},inverse:c.noop,fn:c.program(13,b,i),data:i});if(u||u===0)s+=u;return s+="\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-well",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-reboot-welcome-dialog-content",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function a(e,t){return"\n	While we continue to develop the beta experience, we want your feedback. In case you need some of the missing functionality, you can easily opt-out and go back to the old experience.\n"}function f(e,t){return"\n	Please continue providing us with feedback so we can continue to improve Flickr.\n"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this;s+="Flickr is about the amazing photos you capture and the communities that you build around these photos. The goal of our photo page redesign is to provide you with a fast photo browsing experience and an easy interface to build &amp; maintain relationships.<br>\n<br>\nOver the last 4 weeks, we received a lot of feedback from the Flickr community regarding the photo page design. Based on the feedback, we are experimenting with different variations of the photo page to identify the best experience.<br>\n<br>\n",o=n["if"].call(t,t["opt-out-enabled"],{hash:{},inverse:u.program(3,f,i),fn:u.program(1,a,i),data:i});if(o||o===0)s+=o;return s+="\n<br>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/reboot-welcome-dialog-content",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-photo-opt-out",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<form action="//',(o=n.host)?o=o.call(t,{hash:{},data:i}):(o=t.host,o=typeof o===u?o.apply(t):o),s+=a(o)+'/help/optin" method="post">\n	<input type="hidden" name="photo_opt" value="0">\n	<input type="hidden" name="redirect_url" value="',(o=n["redirect-url"])?o=o.call(t,{hash:{},data:i}):(o=t["redirect-url"],o=typeof o===u?o.apply(t):o),s+=a(o)+'">\n	<input type="submit" class="ui-button" value="Go back to the old experience">\n</form>',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-opt-out",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-photo-well-media",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){var r="",i,s,o;r+='\n	<div class="restricted-interstitial">\n		<div class="restricted-interstitial-message">\n			<h2>',o={hash:{intlName:"photo-page-scrappy.ADULT_CONTENT"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,o):u.call(e,"intlMessage",o)))+"</h2>\n			",s=n["if"].call(e,e.isSignedIn,{hash:{},inverse:l.program(4,p,t),fn:l.program(2,h,t),data:t});if(s||s===0)r+=s;return r+="\n		</div>\n	</div>\n",r}function h(e,t){var r="",i,s;return r+="\n				<p>",s={hash:{intlName:"photo-page-scrappy.MATURE_AUDIENCES"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"<br />",s={hash:{intlName:"photo-page-scrappy.USER_DISCRETION"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"</p>\n				<p><button class='ui-button'><span>",s={hash:{intlName:"photo-page-scrappy.SHOW_ME_THIS_CONTENT_TYPE"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"</span></button></p>\n				<p>",s={hash:{intlName:"photo-page-scrappy.CHANGE_SAFE_SEARCH_IN_SETTINGS"},data:t},r+=a((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,s):u.call(e,"intlHTMLMessage",s)))+"</p>\n			",r}function p(e,t){var r="",i,s,o;return r+="\n				<p>",o={hash:{intlName:"photo-page-scrappy.SIGNED_IN_FOR_CONTENT"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,o):u.call(e,"intlMessage",o)))+' <a href="//',(s=n.host)?s=s.call(e,{hash:{},data:t}):(s=e.host,s=typeof s===f?s.apply(e):s),r+=a(s)+'/signin/" data-track="photoWellSignInClick">',o={hash:{intlName:"common.SIGN_IN"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,o):u.call(e,"intlMessage",o)))+"</a></p>\n			",r}function d(e,t){var r="",i;r+="\n\n	",i=n["if"].call(e,e.isAd,{hash:{},inverse:l.noop,fn:l.program(7,v,t),data:t});if(i||i===0)r+=i;r+="\n		",i=n["if"].call(e,e.isVideo,{hash:{},inverse:l.program(11,g,t),fn:l.program(9,m,t),data:t});if(i||i===0)r+=i;r+="\n	",i=n["if"].call(e,e.isAd,{hash:{},inverse:l.noop,fn:l.program(14,b,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function v(e,t){var n="",r;return n+='\n		<a class="ad-wrapper" href="'+a((r=(r=e.ad,r==null||r===!1?r:r.clickUrl),typeof r===f?r.apply(e):r))+'">\n	',n}function m(e,t){var r="",i;return r+='\n			<div class="videoplayer main-photo" style="width:',(i=n.width)?i=i.call(e,{hash:{},data:t}):(i=e.width,i=typeof i===f?i.apply(e):i),r+=a(i)+"px; height:",(i=n.height)?i=i.call(e,{hash:{},data:t}):(i=e.height,i=typeof i===f?i.apply(e):i),r+=a(i)+'px;"></div>\n		',r}function g(e,t){var r="",i,s,o;r+='\n\n			<div class="facade-of-protection-neue ',i=n["if"].call(e,e["is-video"],{hash:{},inverse:l.noop,fn:l.program(12,y,t),data:t});if(i||i===0)r+=i;return r+='">\n				',o={hash:{},data:t},r+=a((i=n.outlet||e.outlet,i?i.call(e,e["zoom-view"],o):u.call(e,"outlet",e["zoom-view"],o)))+'\n			</div>\n\n			<img width="',(s=n.width)?s=s.call(e,{hash:{},data:t}):(s=e.width,s=typeof s===f?s.apply(e):s),r+=a(s)+'" height="',(s=n.height)?s=s.call(e,{hash:{},data:t}):(s=e.height,s=typeof s===f?s.apply(e):s),r+=a(s)+'" src="',(s=n.src)?s=s.call(e,{hash:{},data:t}):(s=e.src,s=typeof s===f?s.apply(e):s),r+=a(s)+'" class="low-res-photo">\n			<img width="',(s=n.width)?s=s.call(e,{hash:{},data:t}):(s=e.width,s=typeof s===f?s.apply(e):s),r+=a(s)+'" height="',(s=n.height)?s=s.call(e,{hash:{},data:t}):(s=e.height,s=typeof s===f?s.apply(e):s),r+=a(s)+'" src="',(s=n.highResSrc)?s=s.call(e,{hash:{},data:t}):(s=e.highResSrc,s=typeof s===f?s.apply(e):s),r+=a(s)+'" class="main-photo is-hidden" onload="registerFirstPhoto(this)">\n			<noscript>\n				<img width="',(s=n.width)?s=s.call(e,{hash:{},data:t}):(s=e.width,s=typeof s===f?s.apply(e):s),r+=a(s)+'" height="',(s=n.height)?s=s.call(e,{hash:{},data:t}):(s=e.height,s=typeof s===f?s.apply(e):s),r+=a(s)+'" src="',(s=n.highResSrc)?s=s.call(e,{hash:{},data:t}):(s=e.highResSrc,s=typeof s===f?s.apply(e):s),r+=a(s)+'" class="main-photo">\n			</noscript>\n		',r}function y(e,t){return"is-video"}function b(e,t){var r="",i,s;return r+='\n			<span class="ad-info">',s={hash:{intlName:"photo-page-scrappy.FIND_OUT_MORE_AD",brand:(i=e.ad,i==null||i===!1?i:i.brand)},data:t},r+=a((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,s):u.call(e,"intlHTMLMessage",s)))+"</span>\n		</a>\n	",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=n.helperMissing,a=this.escapeExpression,f="function",l=this;o=n["if"].call(t,t.needsInterstitial,{hash:{},inverse:l.program(6,d,i),fn:l.program(1,c,i),data:i});if(o||o===0)s+=o;return s+="\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-well-media",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-well-media-view",function(e){var t=500,n=500,r=100,i;i={photo:{render:function(){var t=this,n,i=this.get("photo"),s,o,u=new Date;return t.preloadImage&&(t.preloadImage.onload=null),s=this.getPhotoForDisplay(),o=this.getPhotoForDisplay({includeSizes:["sq","q","t","s","n"]}),n=this.templates("photo-well-media")({width:s.width,height:s.height,src:o.url,highResSrc:s.url,needsInterstitial:i.getValue("needsInterstitial"),isSignedIn:this.appContext.getViewer().signedIn,isVideo:i.getValue("isVideo"),isAd:this.isAd,"zoom-view":this.subviews["zoom-view"]?this.subviews["zoom-view"].get("container"):""}),this.setContainerHTML(n),this.fire("subviewViewEvent",s),YUI.Env.isServer?(this.serverWidth=s.width,this.serverHeight=s.height):i.getValue("needsInterstitial")||(t.preloadImage=new Image,t.preloadImage.onload=function(){if(this.onloadFired)return;if(!t.isActiveAndInDOM())return;this.onloadFired=!0,e.rapidTracker.beacon(this.name,"photoPageShowedSize"+(/(?:_([a-z]))?\.jpg/.exec(s.url)[1]||"\u00f8").toUpperCase());var n=t.get("container").one(".low-res-photo"),i=t.get("container").one(".main-photo"),o=new Date-u,a;o<r?(i.removeClass("is-hidden").show(),n.hide()):(i.setStyles({position:"absolute",left:0,top:0,opacity:0}),i.removeClass("is-hidden"),a=function(){i.removeAttribute("style"),n.hide()},e.UA.ie?a():e.use("transition",function(e){i.transition({duration:.25,opacity:1},a)}))},t.preloadImage.src=s.url,t.preloadImage.complete&&t.preloadImage.onload()),this}},video:{render:function(){var t,n=this,r=this.get("photo"),i=this.getPhotoForDisplay({excludeSizes:[]});return this.player?(this.player.resize(i.width,i.height),this):(t=this.templates("photo-well-media")({width:i.width,height:i.height,src:i.url,needsInterstitial:r.getValue("needsInterstitial"),isVideo:r.getValue("isVideo"),isSignedIn:this.appContext.getViewer().signedIn,"zoom-view":""}),this.setContainerHTML(t),this.fire("subviewViewEvent",i),YUI.Env.isServer?this:(this.player=new e.FlickrVideoPlayer({container:this.get("container").one(".videoplayer"),model:r,appContext:this.appContext}),n.player.init().then(function(){n}),this.on("destroy",function(){n.player.destroy(),n.player=null}),this))}},yepVideoDisabled:{render:function(){var e,t=this.get("photo"),n=this.getPhotoForDisplay();return e=this.templates("photo-well-media-novideo")({width:n.width,height:n.height,src:n.url,needsInterstitial:t.getValue("needsInterstitial"),isVideo:t.getValue("isVideo")}),this.setContainerHTML(e),this}},ad:{render:function(){var e,t,n;return this.adJSON?t=this.adJSON:(t=this.appContext.adManager.getAdJSON(),this.adJSON=t),n=this.getAdSize(t),e=this.templates("photo-well-ad")({width:n.width,height:n.height,src:t.url,clickUrl:t.clickUrl,brand:t.brand,adsTypeB:this.appContext.flipper.isFlipped("moneyball-ads-type-b")}),this.setContainerHTML(e),this}}},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{"zoom-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(){return!this.appContext.flipper.isFlipped("enable-scrappy-zoom")},disableIfSmall:!0}},initializer:function(e){return this.photoId=e.photoId,this.isAd=!!e.ad,this.ad=e.ad,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var e=this;return this.appContext.getModel("photo-models",e.photoId).then(function(t){e.set("photo",t)})},buildContainer:function(){return YUI.Env.isServer||this.set("clientRendered",!0),this.isAd?i.ad.render.call(this):this.appContext.flipper.isFlipped("yep-video")?i[this.get("photo").getValue("isVideo")?"video":"photo"].render.call(this):i.yepVideoDisabled.render.call(this),this},handleInterstitialDismissButtonClick:function(t){var n=this,r=this.get("personPreferences"),i=this.get("photo"),s=i.getValue("safetyLevel");e.rapidTracker.beacon(this.name,"restrictedContentInterstitialClick"),r.setValue("safeSearch",s),r.registry.remoteUpdate(n.appContext.auth.user.nsid).then(function(e){var t=i.registry.attributeSearch({needsInterstitial:!0});t.forEach(function(e){i.registry.getValue(e,"safetyLevel")<=r.getValue("safeSearch")&&i.registry.setValue(e,"needsInterstitial",!1)}),n.buildContainer()},function(e){n.appContext.error(e.message),n.appContext.error(e.stack),n.onError(n.intlMessage({intlName:"photo-page-scrappy.COULDNT_UPDATE_SETTINGS"}))})},activate:function(){var t=this,n=this.getPhotoForDisplay(),r=this.get("container").one(".main-photo"),i,s;return this.get("photo").getValue("needsInterstitial")||(e.use("global-events",function(e){t.registerEventHandler(e.globalEvents.subscribe("window:resize",function(e){t.set("canvasSizeIsDirty",!0),t.buildContainer()}))}),this.registerEventHandler(e.on("flickr:photo-media-well-update",function(e){t.set("canvasSizeIsDirty",!0),t.buildContainer()})),!this.isAd&&(!t.get("clientRendered")||n.width!==Number(r.getAttribute("width"))||n.height!==Number(r.getAttribute("height")))&&t.buildContainer()),this.registerEventHandler(e.on("flickr:display-note-box",function(n){i=e.Node.create('<div class="note-box"></div>'),s=t.get("container").one(".main-photo").getXY(),t.get("container").append(i),i.setStyles({top:n.noteBoxTop+t.get("container").one(".main-photo").getDOMNode().offsetTop,left:n.noteBoxLeft,width:n.noteBoxWidth,height:n.noteBoxHeight})})),this.appContext.getViewer().signedIn&&this.appContext.getModel("person-preferences-models",t.appContext.auth.user.nsid).then(function(e){t.set("personPreferences",e),t.get("photo").getValue("needsInterstitial")&&t.registerEventHandler(t.get("container").one(".restricted-interstitial-message button").on("click",t.handleInterstitialDismissButtonClick,t))}),this},onError:function(t){var n=this;this.fire("subviewViewEvent","getDialogOffset",function(r){var i=e.Views.dialog.getInstance("dialog-alert",{content:t,attrs:{title:n.intlMessage({intlName:"common.ERROR"}),level:"warning",confirmLabel:n.intlMessage({intlName:"common.OK"})},parent:n,offsetLeft:r});i.show()})},getPhotoForDisplay:function(
e){var t=this.getCanvasSize(),n=this.getPixelRatio(),r=this.get("photo").getSizeToFit(t,e),i,s;return i=Math.min(t.height/n,r.height),s=Math.min(t.width/n,r.width/r.height*i),i=Math.min(i,r.height/r.width*s),{width:Math.round(s),height:Math.round(i),url:r.url,pixelRatio:r.width/s}},getAdSize:function(e){var t=this.getCanvasSize(),n=this.getPixelRatio(),r=80,i=140,s,o;return this.appContext.flipper.isFlipped("moneyball-ads-type-b")&&(t.height-=(r+i)*n,t.width-=i*n),s=Math.min(t.height/n,e.height),o=Math.min(t.width/n,e.width/e.height*s),s=Math.min(s,e.height/e.width*o),{width:o,height:s}},getCanvasSize:function(){var e,r=this.getPixelRatio(),i;return this.get("canvasSizeIsDirty")?YUI.Env.isServer||(i=this.get("container").ancestor(),i&&(e=i.get("region"),e.width>0&&e.height>0&&(this.set("canvasSizeIsDirty",!1),this.set("cachedCanvasSize",e),this.appContext.setCookie({remove:!0,cookieName:"photoPW",path:"/photos/",cookieValue:e.width}),this.appContext.setCookie({remove:!0,cookieName:"photoPH",path:"/photos/",cookieValue:e.height}),this.appContext.setCookie({remove:!0,cookieName:"density",path:"/photos/",cookieValue:r})))):e=this.get("cachedCanvasSize"),e||(e={top:0,left:0,bottom:n,right:t,width:parseInt(this.appContext.getCookie("photoPW"),10)||t,height:parseInt(this.appContext.getCookie("photoPH"),10)||n}),e.height*=r,e.width*=r,e},getPixelRatio:function(){return this.appContext.getViewer().getPixelRatio()}},{ATTRS:{canvasSizeIsDirty:{value:!0,setter:function(e){return!!e}},cachedCanvasSize:{getter:function(t){return e.merge(t)},setter:function(t){return e.merge(t)}}}})},"@VERSION@",{requires:["flog","flickr-view","hermes-template-photo-well-media","hermes-template-photo-well-media-novideo","moment","flickr-video-player","hermes-template-photo-well-ad","zoom-view"],optional:["photo-models"],langBundles:["common","photo-page-scrappy"]});
YUI.add("hermes-template-head-meta",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function d(e,t){var n="";return n+='description="'+l(typeof e===f?e.apply(e):e)+'"',n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=n.helperMissing,h=this,p=n.blockHelperMissing;s+='<meta name="',(o=n.metaName)?o=o.call(t,{hash:{},data:i}):(o=t.metaName,o=typeof o===f?o.apply(t):o),s+=l(o)+'" content="',a={hash:{},data:i},s+=l((o=n.renderMetaInfo||t.renderMetaInfo,o?o.call(t,t.metaValue,a):c.call(t,"renderMetaInfo",t.metaValue,a)))+'" ',a={hash:{},inverse:h.noop,fn:h.program(1,d,i),data:i},(u=n.metaDescription)?u=u.call(t,a):(u=t.metaDescription,u=typeof u===f?u.apply(t):u),n.metaDescription||(u=p.call(t,u,a));if(u||u===0)s+=u;return s+=' data-dynamic="true">\n',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/head-meta",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-head-link",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function h(e,t){var r="",i;return r+='id="',(i=n.id)?i=i.call(e,{hash:{},data:t}):(i=e.id,i=typeof i===a?i.apply(e):i),r+=f(i)+'"',r}function p(e,t){var r="",i;return r+='rev="',(i=n.rev)?i=i.call(e,{hash:{},data:t}):(i=e.rev,i=typeof i===a?i.apply(e):i),r+=f(i)+'"',r}function d(e,t){var r="",i;return r+='rel="',(i=n.rel)?i=i.call(e,{hash:{},data:t}):(i=e.rel,i=typeof i===a?i.apply(e):i),r+=f(i)+'"',r}function v(e,t){var r="",i;return r+='type="',(i=n.type)?i=i.call(e,{hash:{},data:t}):(i=e.type,i=typeof i===a?i.apply(e):i),r+=f(i)+'"',r}function m(e,t){var r="",i;return r+='media="',(i=n.media)?i=i.call(e,{hash:{},data:t}):(i=e.media,i=typeof i===a?i.apply(e):i),r+=f(i)+'"',r}function g(e,t){var r="",i;return r+='href="',(i=n.href)?i=i.call(e,{hash:{},data:t}):(i=e.href,i=typeof i===a?i.apply(e):i),r+=f(i)+'"',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.helperMissing;s+="<link \n	",o=n["if"].call(t,t.id,{hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i});if(o||o===0)s+=o;s+=" \n	",o=n["if"].call(t,t.rev,{hash:{},inverse:l.noop,fn:l.program(3,p,i),data:i});if(o||o===0)s+=o;s+=" \n	",o=n["if"].call(t,t.rel,{hash:{},inverse:l.noop,fn:l.program(5,d,i),data:i});if(o||o===0)s+=o;s+=" \n	",o=n["if"].call(t,t.type,{hash:{},inverse:l.noop,fn:l.program(7,v,i),data:i});if(o||o===0)s+=o;s+=" \n	",o=n["if"].call(t,t.media,{hash:{},inverse:l.noop,fn:l.program(9,m,i),data:i});if(o||o===0)s+=o;s+=" \n	",o=n["if"].call(t,t.href,{hash:{},inverse:l.noop,fn:l.program(11,g,i),data:i});if(o||o===0)s+=o;return s+=' \n\ndata-dynamic="true" data-dynamic-added-by="',u={hash:{},data:i},s+=f((o=n.obfuscateInternals||t.obfuscateInternals,o?o.call(t,t.addedBy,u):c.call(t,"obfuscateInternals",t.addedBy,u)))+'">',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/head-link",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-head-meta-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{initializer:function(e){return this.photoId=e.photoId,this},subviewConfig:{},buildContainer:function(){return this},loadState:function(){var t=this;return e.Promise.all([t.appContext.getModel("photo-head-meta-models",t.photoId),t.appContext.getModel("photo-models",t.photoId)]).then(function(e){t.set("photo-meta",e[0]),t.set("photo",e[1])})},buildHeadContainer:function(){var t=this.get("photo-meta"),n=this.get("photo"),r=e.url(),i=t.getFieldsForDisplay(),s="",o=this,u=[{id:"canonicalurl",rel:"canonical",href:r+n.getValue("url")},{rel:"alternative",type:"application/json+oembed",href:r+"/services/oembed?url="+encodeURI(r+n.getValue("url"))+"&format=json",title:n.getValue("title")},{rel:"alternative",type:"text/xml+oembed",href:r+"/services/oembed?url="+encodeURI(r+n.getValue("url"))+"&format=xml",title:n.getValue("title")},{rel:"alternative",media:"only screen and (max-width: 640px)",href:"https://m.flickr.com"+encodeURI(n.getValue("url")+"/")}];return Object.keys(i).forEach(function(e){typeof i[e]=="object"&&e==="pinterest"?s+=o.templates("head-meta")({metaName:e,noPin:!0,metaValue:i[e].nopin,metaDescription:i[e].reason})+"\n":s+=o.templates("head-meta")({metaName:e,metaValue:i[e]})+"\n"}),u.forEach(function(e){e.addedBy=o.name,s+=o.templates("head-link")(e)+"\n"}),this.set("headContainer",s),YUI.Env.isServer||this.updateHead(),this}})},"@VERSION@",{requires:["flickr-view","hermes-template-head-meta","hermes-template-head-link"],optional:["photo-head-meta-models","photo-route","url"]});
YUI.add("photo-page-lightbox-scrappy-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var n=this;return this.backToURL=t.backToURL,this.entryTypeIntlKey=t.entryTypeIntlKey,this.photoId=t.photoId,this.isOwner=t.isOwner,this.context=e.clone(t.context,!0),this.appContext.experiments.fullscreen.enableFullscreen(),t.realFullscreen=!0,t.isOwner=this.isOwner,this.enableZoom=this.appContext.flipper.isFlipped("enable-scrappy-zoom"),this.appContext.getViewer().signedIn&&(t.signinPendingQueue=e.SigninHelper.checkPendingQueue(this.appContext)),this.appContext.getModel("photo-models",this.photoId).then(function(t){t.on("valuesChanged",function(t){t.title&&e.one("head title").set("text",n.intlMessage({intlName:"photo-page-scrappy.PAGE_TITLE",title:t.title.newVal}))})}),this},subviewConfig:{"photo-well-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,dealbreaker:!0},"photo-head-meta-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},buildContainer:function(){var t,n=this.subviews["photo-well-view"].get("container");return n.addClass("scrappy-photo-page-enabled"),n.addClass("is-real-fullscreen"),this.enableZoom&&n.addClass("enable-zoom"),t=this.templates("photo-page-lightbox")({"photo-well-view":n}),this.setContainerHTML(t),e.fletrics.increment("test.photo.page.requests"),this},buildErrorContainer:function(){var t={};!YUI.Env.isServer&&e.config.flickr.requestConfig.auth&&e.config.flickr.requestConfig.auth.isInsecureGod&&(t.message="This is a client side panda! You're seeing this because this view failed to loadState itself, one of its dealbreaker subviews failed to loadState or two non-dealbreaker subviews failed to loadState.",t.environment="Client"),YUI.Env.isServer||e.use("rrd",function(e){e.RRD.queue({event:"flickr.hermes.clientpanda",title:"ClientPandas"},e.url("/beacon_flanal_reboot_event.gne"))}),this.setContainerHTML(this.templates("error-500")(t))},activate:function(){return this},closeDialog:function(t){e.config.win.location.href=this.backToURL},buildHeadContainer:function(){var e=this.subviews["photo-head-meta-view"].get("headContainer");return this.set("headContainer",e),this},getTrackingSegments:function(){return{context:this.context.modelName.replace("-models",""),vwrOwner:this.isOwner?1:0}},destructor:function(){clearTimeout(this.scrollTimeout)}},{ATTRS:{spaceid:{value:792600552}}}),e.Base.plug(e.Views[this.name],e.Plugin.FlickrView.TTFPRecorderPlugin,{selector:".main-photo"})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-page-lightbox","photo-css","util-css","fletrics","ttfp-recorder-plugin","signin-helper","hermes-template-error-500","url","fluid-css"],optional:["photo-well-view","photo-head-meta-view"],langBundles:["common","photo-page-scrappy"]});
YUI.add("photo-well-scrappy-view",function(e){var t=1,n=5;e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.photoId=t.photoId,this.contextData=e.clone(t.context,!0),this.entryURL=t.backToURL,this.entryTypeIntlKey=t.entryTypeIntlKey,this.isAd=!!t.ad,this.publisherUrl=t.publisherUrl,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},additionalViewClasses:["centered-content"],subviewConfig:{"photo-well-media-scrappy-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"photo-notes-scrappy-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(){return!this.appContext.flipper.isFlipped("enable-scrappy-notes")}},"photo-engagement-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"context-slider-scrappy-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"photo-sidebar-toggle-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,disabled:function(){return!this.appContext.experiments.fullscreen.showFullscreenToggle()}},"attribution-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["is-real-fullscreen","photo-attribution"],disabled:function(){return!this.appContext.experiments.fullscreen.showAttributionOverlay()}},"photo-sidebar-actions-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["is-real-fullscreen"],disabled:function(){return this.appContext.experiments.fullscreen.disableRealFullscreenButtons()}},"people-notes-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:!0}},buildContainer:function(){var e=this,t,n="",r,i=0,s,o,u=".navigate-prev",a=".navigate-next",f,l,c,h;return this.appContext.experiments.fullscreen.isRealFullscreen()&&this.subviews["photo-sidebar-actions-view"]&&this.subviews["photo-sidebar-actions-view"].get("container").addClass("is-hidden"),this.appContext.experiments.fullscreen.isRealFullscreen()&&(this.appContext.experiments.fullscreen.getMode()?this.subviews["attribution-view"]&&(YUI.Env.isServer||this.subviews["attribution-view"].get("container").removeClass("is-always-hidden"),this.contextData.modelName!=="photoList-models"&&this.contextData.modelName!=="explore-models"&&this.subviews["attribution-view"].get("container").addClass("is-hidden"),n=this.subviews["attribution-view"].get("container")):this.subviews["attribution-view"]&&(this.subviews["attribution-view"].get("container").addClass("is-always-hidden"),n=this.subviews["attribution-view"].get("container"))),this.get("contextModel")&&(r=this.get("contextModel").getValue("photoContextList").getList(),r.length>2&&r.some(function(t){return i++,t.getValue("id")===e.photoId})&&(s=r.slice(i-2,i-1),o=r.slice(i,i+1),s&&s.length>0&&(f=e.setupNavLink(s[0],u,"previous")),o&&o.length>0&&(l=e.setupNavLink(o[0],a,"next")))),c=this.getPhotoWellHeight(),h=c-70,t=this.templates("photo-well-scrappy")({"photo-well-media-view":this.subviews["photo-well-media-scrappy-view"].get("container"),"photo-notes-scrappy-view":this.subviews["photo-notes-scrappy-view"]?this.subviews["photo-notes-scrappy-view"].get("container"):"","context-slider-view":this.subviews["context-slider-scrappy-view"].get("container"),"is-hidden":!f&&!l,"prev-is-not-clickable":!f,"next-is-not-clickable":!l,"prev-url":f,"next-url":l,"is-ad":this.isAd,"photo-sidebar-toggle-view":this.subviews["photo-sidebar-toggle-view"]?this.subviews["photo-sidebar-toggle-view"].get("container"):"","photo-sidebar-actions-view":this.subviews["photo-sidebar-actions-view"]?this.subviews["photo-sidebar-actions-view"].get("container"):"","attribution-view":n,"people-notes-view":this.subviews["people-notes-view"]?this.subviews["people-notes-view"].get("container"):"",height:c,"photo-engagement-view":this.subviews["photo-engagement-view"].get("container"),navHeight:h,entryURL:this.entryURL,backToLabel:this.intlMessage({intlName:"photo-page-scrappy."+this.entryTypeIntlKey}),enableZoom:this.appContext.flipper.isFlipped("enable-scrappy-zoom")}),this.setContainerHTML(t),YUI.Env.isServer||(this.subviews["photo-well-media-scrappy-view"]&&this.subviews["photo-well-media-scrappy-view"].fire("parentViewEvent","photoWellResized"),this.subviews["photo-notes-scrappy-view"]&&this.subviews["photo-notes-scrappy-view"].fire("parentViewEvent","photoWellResized")),YUI.Env.isServer&&(this.serverWidth=this.subviews["photo-well-media-scrappy-view"].serverWidth,this.serverHeight=this.subviews["photo-well-media-scrappy-view"].serverHeight),this},loadState:function(){var t=this,n=[];return n.push(this.appContext.getModel("photo-models",this.photoId).then(function(e){if(!e)throw new Error("[photo-well-view] Invalid photoModel returned from getModel");t.set("photo",e)})),this.contextData&&this.contextData.modelName&&this.contextData.params&&n.push(this.appContext.getModelRegistry(this.contextData.modelName).then(function(e){var n;if(e){n=e.attributeSearch(t.contextData.params);if(n&&n.length&&e.exists(n[0]))return t.appContext.getModel(t.contextData.modelName,n[0]).then(function(e){e&&t.set("contextModel",e)})}}).then(null,function(){return"whatever"})),e.Promise.all(n)},setLinkAsAdFriendly:function(e){var t=e.currentTarget;t.hasClass("navigate-next")?this.appContext.adManager.setAdCouldBeShown(!0,"next",t.getAttribute("href")):this.appContext.adManager.setAdCouldBeShown(!0,"previous",t.getAttribute("href"))},animateNavigation:function(){var t=e.all(".navigate-target"),n=this.get("container"),r=n.one(".photo-sidebar-toggle-view"),i=n.one(".attribution-view"),s=1500,o=250,u=!1,a=!1,f,l=!0,c=this;this.appContext.experiments.fullscreen.isRealFullscreen()&&(s=(s-500)/2,u=!0,a=this.appContext.experiments.fullscreen.getMode()),this.registerEventHandler(this.get("container").on("mousemove",e.betterThrottle(function(e){f=n.one(".photo-sidebar-actions-view"),t&&l&&t.removeClass("is-hidden"),u&&l&&(f&&f.removeClass("is-hidden"),r&&r.removeClass("is-hidden"),i&&i.removeClass("is-hidden")),clearTimeout(c.movingTimeout
),clearTimeout(c.initialTimeout),l=!0,c.movingTimeout=setTimeout(function(){f=n.one(".photo-sidebar-actions-view"),u&&(f&&f.addClass("is-hidden"),i&&i.addClass("is-hidden"))},s*2)},o))),this.contextData.modelName!=="photoList-models"&&this.contextData.modelName!=="explore-models"&&(l=!1),c.initialTimeout=setTimeout(function(){l=!0,f=n.one(".photo-sidebar-actions-view"),u&&l&&(f&&f.addClass("is-hidden"),i&&i.addClass("is-hidden"))},s*2)},activate:function(){var r=this,i=this.contextData,s=0,o,u,a,f,l=".navigate-prev",c=".navigate-next",h=this.appContext.getViewer().prefs.keyboardShortcutsEnabled;return YUI.Env.isServer||(u=e.getLocation(),a=u.protocol,f=u.hostname,r.appContext.getModel(i.modelName,i.params).then(function(e){r.set("contextModel",e)},function(t){if(!t.getModelFailure&&t.code!==1||i.modelName==="photostream-models")throw e.one(l).hide(),e.one(c).hide(),t;return r.contextData.modelName="photostream-models",r.contextData.params.id=r.get("photo").getValue("owner").getValue("nsid"),r.appContext.getModel("photostream-models",r.contextData.params).then(function(e){r.set("contextModel",e)})}).then(function(){var t=r.get("contextModel").getValue("photoContextList"),n=t.getList(),o,u,h,p,d;return n.length>2&&n.some(function(e){return s++,e.getValue("id")===r.photoId})&&(u=n.slice(s-2,s-1),h=n.slice(s,s+1),u&&u.length>0&&(p=r.setupNavLink(u[0],l,"previous"),p&&(r.updateNavLinks(r.get("container").one(l),a,f,p),r.get("container").one(l).removeClass("no-click"))),h&&h.length>0&&(d=r.setupNavLink(h[0],c,"next"),d&&(r.updateNavLinks(r.get("container").one(c),a,f,d),r.get("container").one(c).removeClass("no-click")))),o=e.merge(i.params,{photoId:r.photoId,numNext:6,numPrev:6,refetchAt:12}),t.getContext(o)}).then(function(i){function s(s,o){var u=r.get("container").one(s),l,c,h,p,d,v,m=i&&i[o]&&i[o].length,g;if(!u)return;if(!m){u.remove();return}u.removeClass("no-click"),l=r.setupNavLink(i[o][0],s,o);if(r.isAd)h=r.appContext.adManager.origin,o===h.arrow?(u.setAttribute("href",h.url),u.removeClass("is-hidden")):(u.setAttribute("href",l),u.removeClass("is-hidden"));else{r.updateNavLinks(u,a,f,l),c=r.subviews["photo-well-media-scrappy-view"].getCanvasSize();for(v=0;v<n;v++){if(!i[o][v])break;p=i[o][v].getSizeToFit(c,{includeSizes:["sq","q","t","s","n"]}),p&&p.url&&(d=new Image,d.src=p.url)}for(v=0;v<t;v++){if(!i[o][v])break;p=i[o][v].getSizeToFit(c),p&&p.url&&(d=new Image,g=e.guid(),window.LH&&window.LH.mark("mark_time_to_load_photo_only_start"+g),d.onload=function(){if(d.onloadFired)return;d.onloadFired=!0;try{window.LH.mark("mark_time_to_load_photo_only"+g),window.LH.measure("time_to_load_photo_only",{startMark:"mark_time_to_load_photo_only_start"+g,endMark:"mark_time_to_load_photo_only"+g})}catch(t){e.Flog.warn("time to load photo: Missing start mark")}},d.src=p.url,d.complete&&(d.onloadFired=!0))}}}r.appContext.adManager.updateContext({prev:i.previous[0],current:r.get("photo"),next:i.next[0],type:r.contextData.modelName,entryURL:r.entryURL}),s(c,"next"),s(l,"previous"),r.animateNavigation(),r.isAd&&r.appContext.adManager.markAdAsSeen()},function(e){if(e.notInContext)return r.get("contextModel").setValue("photoContextList",[]),r.contextData.modelName="photostream-models",r.contextData.params.id=r.get("photo").getValue("owner").getValue("nsid"),r.activate();throw e}).then(null,function(e){r.appContext.warn("There was a problem initializing the next/previous controls.",e&&e.message?e.message:e,e&&e.stack?e.stack:"")}),h&&this.attachKeyEvent("down:37,75,39,74",r.handlePrevNextKeys.bind(r)),this.get("photo").getValue("isOwner")||this.appContext.getViewCounter().queue(this.get("photo").getValue("id"),this.publisherUrl||this.appContext.getReferrer())),o={":ad":r.setLinkAsAdFriendly},h&&this.attachKeyEvent("down:66",function(t){t.preventDefault(),e.rapidTracker.beacon(r.name,"backToContextKeyPress"),r.appContext.flapp.hasRoute(r.entryURL)?r.appContext.flapp.navigate(r.entryURL):e.config.win.location.href=r.entryURL}),r.registerEventHandler(e.on("resize",e.betterThrottle(function(e){r.set("canvasSizeIsDirty",!0),r.buildContainer()},16))),r.buildContainer(),r.attachEvents(o),this},getPhotoWellHeight:function(){var e=500,t=this.appContext.viewportData.getWidth(),n=this.appContext.viewportData.getHeight()-50,r=1,i=2.3,s=2.75,o=120,u=t/r+o,a=t/i+o,f=t/s,l;return n>u?l=t/r:n>a?l=n-o:n>f?l=n-o+o*(n-a)/(f-a):l=n,Math.max(e,Math.round(l))},setupNavLink:function(t,n,r){var i=this.get("container").one(n),s,o;if(!t){i.remove();return}s=t,o=e.URLHelper.getPhotoPage({photoId:s.getValue("id"),pathAlias:s.getValue("owner").getValue("pathAlias"),contextSuffix:this.get("contextModel").getValue("urlSuffix")});if(!o||o==="#"){this.appContext.warn("[photo-well-view] Invalid next/prev URL:",o),i.remove();return}return o},updateNavLinks:function(e,t,n,r){e.setAttribute("href",t+"//"+n+r),e.removeClass("is-hidden")},destructor:function(){clearTimeout(this.movingTimeout),clearTimeout(this.initialTimeout),this.movingTimeout=null,this.initialTimeout=null},handlePrevNextKeys:function(t){var n=this,r,i,s,o=50;if(t.button===37||t.button===75)i=".navigate-prev",s="previous",e.rapidTracker.beacon(this.name,"prevPhotoKeyPress");else if(t.button===39||t.button===74)i=".navigate-next",s="next",e.rapidTracker.beacon(this.name,"nextPhotoKeyPress");i&&n.get("container").one(i)&&(t.preventDefault(),r=n.get("container").one(i).getAttribute("href"),r&&r!=="#"&&(n.keyboardNavigation&&n.keyboardNavigation.url&&r===n.keyboardNavigation.url&&(new Date).getTime()-n.keyboardNavigation.time<o?n.appContext.debug("[photo-well-view] Ignoring duplicate keyboard navigation within "+o+"ms",r):(n.keyboardNavigation={url:r,time:(new Date).getTime()},this.appContext.adManager.setAdCouldBeShown(!0,s,r),n.appContext.flapp.navigate(r))))},handleContextMenu:function(e){e.preventDefault(),this.fire("parentViewEvent","rightClickPhoto")}})},"@VERSION@",{requires:["yui-throttle","flickr-view","hermes-template-photo-well-scrappy","photo-well-scrappy-css","url-helper"
,"better-throttle"],optional:["photo-well-media-scrappy-view","context-slider-scrappy-view","photo-engagement-view","photo-models","photo-route"],langBundles:["common","photo-page-scrappy"]});
YUI.add("hermes-template-global-nav",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return" has-filter-bar"}function d(e,t){return"styleguide-global-nav fluid"}function v(e,t){var r="",i,s,o;r+='\n			<li role="menuitem" class="gn-signup">\n				<a data-track="gnSignupClick" class="gn-title ',o={hash:{},inverse:f.noop,fn:f.program(6,m,t),data:t},s=(i=n.isFlipped||e.isFlipped,i?i.call(e,e.flippers,"styleguide-global-nav",o):l.call(e,"isFlipped",e.flippers,"styleguide-global-nav",o));if(s||s===0)r+=s;return r+='" href="/signup">',o={hash:{intlName:"common.SIGN_UP"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+"</a>\n			</li>\n		",r}function m(e,t){return"butt"}function g(e,t){var r="",i,s,o;r+='\n			<li role="menuitem" data-context="you">\n				<a data-track="gnYouMainClick" class="gn-title you" href="'+c((i=(i=e.viewer,i==null||i===!1?i:i.url),typeof i===h?i.apply(e):i))+'" aria-haspopup="true">',o={hash:{intlName:"common.YOU"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a>\n				<ul class="gn-submenu" role="menu">\n					',s=n["if"].call(e,e.showCameraRoll,{hash:{},inverse:f.noop,fn:f.program(9,y,t),data:t});if(s||s===0)r+=s;r+='\n					<li class="menuitem"><a data-track="gnYouPhotostreamClick" href="'+c((i=(i=e.viewer,i==null||i===!1?i:i.url),typeof i===h?i.apply(e):i))+'">',o={hash:{intlName:"common.PHOTOSTREAM"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n					<li class="menuitem"><a data-track="gnYouSetsClick" href="'+c((i=(i=(i=e.viewer,i==null||i===!1?i:i.urls),i==null||i===!1?i:i.albums),typeof i===h?i.apply(e):i))+'">',s=n["if"].call(e,(i=e.elements,i==null||i===!1?i:i.set_not_album),{hash:{},inverse:f.program(13,w,t),fn:f.program(11,b,t),data:t});if(s||s===0)r+=s;r+='</a></li>\n					<li class="menuitem"><a data-track="gnYouMapClick" href="'+c((i=(i=(i=e.viewer,i==null||i===!1?i:i.urls),i==null||i===!1?i:i.map),typeof i===h?i.apply(e):i))+'">',o={hash:{intlName:"common.MAP"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n					<li class="menuitem"><a data-track="gnYouFavoritesClick" href="'+c((i=(i=(i=e.viewer,i==null||i===!1?i:i.urls),i==null||i===!1?i:i.favorites),typeof i===h?i.apply(e):i))+'">',o={hash:{intlName:"common.FAVORITES"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n					<li class="menuitem"><a data-track="gnYouGalleriesClick" href="'+c((i=(i=(i=e.viewer,i==null||i===!1?i:i.urls),i==null||i===!1?i:i.galleries),typeof i===h?i.apply(e):i))+'">',o={hash:{intlName:"common.GALLERIES"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n					<li class="menuitem"><a data-track="gnYouRecentActivityClick" href="/activity">',o={hash:{intlName:"global-nav.RECENT_ACTIVITY"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+"</a></li>\n					",s=n["if"].call(e,(i=e.elements,i==null||i===!1?i:i.stats),{hash:{},inverse:f.noop,fn:f.program(15,E,t),data:t});if(s||s===0)r+=s;return r+='\n					<li class="menuitem"><a data-track="gnYouOrganizeClick" href="/photos/organize">',o={hash:{intlName:"global-nav.ORGANIZE"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n					<li class="menuitem"><a class="server-only-link" data-track="gnYouCreationsClick" href="'+c((i=(i=(i=e.viewer,i==null||i===!1?i:i.urls),i==null||i===!1?i:i.creations),typeof i===h?i.apply(e):i))+'">',o={hash:{intlName:"global-nav.CREATIONS"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+"</a></li>\n				</ul>\n			</li>\n		",r}function y(e,t){var r="",i,s;return r+='<li class="menuitem"><a class="server-only-link" data-track="gnYouCameraRollClick" href="'+c((i=(i=(i=e.viewer,i==null||i===!1?i:i.urls),i==null||i===!1?i:i.cameraroll),typeof i===h?i.apply(e):i))+'">',s={hash:{intlName:"global-nav.CAMERAROLL"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+'<span class="label-beta">',s={hash:{intlName:"common.BETA"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</span></a></li>",r}function b(e,t){var r,i;return i={hash:{intlName:"common.SETS"},data:t},c((r=n.intlMessage||e.intlMessage,r?r.call(e,i):l.call(e,"intlMessage",i)))}function w(e,t){var r,i;return i={hash:{intlName:"common.ALBUMS"},data:t},c((r=n.intlMessage||e.intlMessage,r?r.call(e,i):l.call(e,"intlMessage",i)))}function E(e,t){var r="",i,s;return r+='<li class="menuitem"><a data-track="gnYouStatsClick" href="'+c((i=(i=(i=e.viewer,i==null||i===!1?i:i.urls),i==null||i===!1?i:i.stats),typeof i===h?i.apply(e):i))+'">',s={hash:{intlName:"global-nav.STATS"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</a></li>",r}function S(e,t){var r="",i,s;return r+='\n			<li class="toplink">\n				<a data-track="gnYouMainClick" class="gn-link" href="'+c((i=(i=(i=e.viewer,i==null||i===!1?i:i.urls),i==null||i===!1?i:i.photostream),typeof i===h?i.apply(e):i))+'"><span>',s={hash:{intlName:"global-nav.YOUR_PHOTOSTREAM"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</span></a>\n			</li>\n		",r}function x(e,t){var r="",i,s;return r+='\n			<li role="menuitem" data-context="contacts">\n				<a data-track="gnContactsMainClick" class="gn-title contacts" href="/photos/friends" aria-haspopup="true">',s={hash:{intlName:"global-nav.PEOPLE"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+'</a>\n				<ul class="gn-submenu" role="menu">\n					<li class="menuitem"><a data-track="gnContactsRecentPhotosClick" href="/photos/friends">',s={hash:{intlName:"global-nav.PHOTOS_FROM"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)
))+'</a></li>\n					<li class="menuitem"><a data-track="gnContactsPhotosOfContactsClick" href="/photosof/contacts">',s={hash:{intlName:"global-nav.PHOTOS_OF"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+'</a></li>\n					<li class="menuitem"><a data-track="gnContactsContactListClick" href="'+c((i=(i=(i=e.viewer,i==null||i===!1?i:i.urls),i==null||i===!1?i:i.list),typeof i===h?i.apply(e):i))+'">',s={hash:{intlName:"global-nav.LIST"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+'</a></li>\n					<li class="menuitem"><a data-track="gnContactsAddContactsClick" href="/import/people">',s={hash:{intlName:"global-nav.FIND_FRIENDS"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</a></li>\n				</ul>\n			</li>\n		",r}function T(e,t){var r="",i,s,o;r+='\n			<li role="menuitem" data-context="groups">\n				<a data-track="gnGroupsMainClick" class="gn-title groups" href="/groups" aria-haspopup="true">',o={hash:{intlName:"global-nav.GROUPS"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a>\n				<ul class="gn-submenu" role="menu">\n					<li class="menuitem"><a data-track="gnGroupsGroupsListClick" href="/groups">',o={hash:{intlName:"global-nav.GROUPS_LIST"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n					<li class="menuitem"><a data-track="gnGroupsRecentDiscussionsClick" href="/recent.gne">',o={hash:{intlName:"global-nav.RECENT_DISCUSSIONS"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+"</a></li>\n					",o={hash:{},inverse:f.noop,fn:f.program(22,N,t),data:t},s=(i=n.isNotFlipped||e.isNotFlipped,i?i.call(e,e.flippers,"reboot-unified-search",o):l.call(e,"isNotFlipped",e.flippers,"reboot-unified-search",o));if(s||s===0)r+=s;return r+='\n					<li class="menuitem"><a data-track="gnGroupsCreateAGroupClick" href="/groups_create.gne">',o={hash:{intlName:"global-nav.CREATE_A_GROUP"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+"</a></li>\n				</ul>\n			</li>\n		",r}function N(e,t){var r="",i,s;return r+='<li class="menuitem"><a data-track="gnGroupsSearchGroupsClick" href="/search/groups">',s={hash:{intlName:"global-nav.SEARCH_GROUPS"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</a></li>",r}function C(e,t){var r="",i,s,o;r+='\n			<li role="menuitem" data-context="explore">\n				<a data-track="gnExploreMainClick" class="gn-title explore" href="/explore" aria-haspopup="true">',o={hash:{intlName:"common.EXPLORE"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a>\n				<ul class="gn-submenu" role="menu">\n					<li role="menuitem"><a data-track="gnExploreRecentPhotosClick" href="/explore">',o={hash:{intlName:"global-nav.RECENT_PHOTOS"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n					<li role="menuitem"><a data-track="gnExploreTheCommonsClick" href="/commons">',o={hash:{intlName:"global-nav.THE_COMMONS"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n					<li role="menuitem"><a data-track="gnExplore20under20Click" href="/20under20">20under20</a></li>\n					<li role="menuitem"><a data-track="gnExploreGalleriesClick" href="/galleries">',o={hash:{intlName:"global-nav.GALLERIES"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n					<li role="menuitem"><a data-track="gnExploreWorldMapClick" href="/map">',o={hash:{intlName:"global-nav.WORLD_MAP"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n					<li role="menuitem"><a data-track="gnExploreAppGardenClick" href="/services">',o={hash:{intlName:"global-nav.APP_GARDEN"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n					<li role="menuitem"><a data-track="gnExploreCameraFinderClick" href="/cameras">',o={hash:{intlName:"global-nav.CAMERA_FINDER"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+"</a></li>\n					",s=n["if"].call(e,(i=e.elements,i==null||i===!1?i:i.weekly_flickr),{hash:{},inverse:f.noop,fn:f.program(25,k,t),data:t});if(s||s===0)r+=s;return r+='\n					<li role="menuitem"><a data-track="gnExploreFlickrBlogClick" href="https://blog.flickr.net/">',o={hash:{intlName:"global-nav.FLICKR_BLOG"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+"</a></li>\n				</ul>\n			</li>\n		",r}function k(e,t){var r="",i,s;return r+='<li role="menuitem"><a data-track="gnExploreWeeklyFlickrClick" href="/photos/flickr/sets/72157639868074114/">',s={hash:{intlName:"global-nav.THE_WEEKLY_FLICKR"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</a></li>",r}function L(e,t){var r="",i,s;return r+='\n			<li role="menuitem" class="gn-create">\n				<a data-track="gnCreateMainClick" class="gn-title" href="/create">',s={hash:{intlName:"global-nav.CREATE"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</a>\n			</li>\n		",r}function A(e,t){var r="",i,s;return r+='\n			<li role="menuitem" data-context="create">\n				<a data-track="gnCreateMainClick" class="gn-title create" href="/create" aria-haspopup="true">',s={hash:{intlName:"global-nav.CREATE"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+'</a>\n				<ul class="gn-submenu" role="menu">\n					<!-- <li class="menuitem"><a data-track="gnCreateFooClick" href="/foo">',s={hash:{intlName:"global-nav.FOO"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</a></li> -->\n				</ul>\n			</li>\n		",r}function O(e,t){var r="",i,s;return r+='\n			<li role="menuitem" class="gn-upload">\n				<a data-track="gnUploadMain" class="gn-title" href="/upload">'
,s={hash:{intlName:"global-nav.UPLOAD"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</a>\n			</li>\n		",r}function M(e,t){var r="",i;r+="\n			",i=n["if"].call(e,e.showAutosuggest,{hash:{},inverse:f.program(36,D,t),fn:f.program(34,_,t),data:t});if(i||i===0)r+=i;return r+="\n		",r}function _(e,t){var r="",i,s;return r+='\n				<li role="menuitem">\n					',s={hash:{},data:t},r+=c((i=n.outlet||e.outlet,i?i.call(e,e["autosuggest-view"],s):l.call(e,"outlet",e["autosuggest-view"],s)))+"\n				</li>\n			",r}function D(e,t){var r="",i;r+="\n				",i=n["if"].call(e,e.showSmartSearchBar,{hash:{},inverse:f.program(39,H,t),fn:f.program(37,P,t),data:t});if(i||i===0)r+=i;return r+="\n			",r}function P(e,t){var r="",i,s;return r+='\n					<li role="menuitem">\n						',s={hash:{},data:t},r+=c((i=n.outlet||e.outlet,i?i.call(e,e["search-bar-view"],s):l.call(e,"outlet",e["search-bar-view"],s)))+"\n					</li>\n				",r}function H(e,t){var r="",i,s;return r+='\n					<li role="menuitem">\n						<form method="get" role="search">\n							<input type="text" name="text" value="',(i=n.searchValue)?i=i.call(e,{hash:{},data:t}):(i=e.searchValue,i=typeof i===h?i.apply(e):i),r+=c(i)+'" id="gn-search-field" autocomplete="off" aria-label="Search" role="textbox">\n							<input type="submit" data-track="gnSearchSearchIcon" class="search-icon" tabindex="-1" aria-label="',s={hash:{intlName:"global-nav.SEARCH"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+'" role="button">\n						</form>\n					</li>\n				',r}function B(e,t){var r="",i,s;return r+='\n			<li role="menuitem">\n				',s={hash:{},data:t},r+=c((i=n.outlet||e.outlet,i?i.call(e,e["notifications-menu-view"],s):l.call(e,"outlet",e["notifications-menu-view"],s)))+"\n			</li>\n		",r}function j(e,t){var r="",i,s;return r+='\n			<li role="menuitem">\n				',s={hash:{},data:t},r+=c((i=n.outlet||e.outlet,i?i.call(e,e["account-menu-view"],s):l.call(e,"outlet",e["account-menu-view"],s)))+"\n			</li>\n		",r}function F(e,t){var r="",i,s;return r+='\n			<li role="menuitem" class="gn-signin">\n				<a data-track="gnSignin" class="gn-title" href="/signin">',s={hash:{intlName:"global-nav.SIGN_IN"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</a>\n			</li>\n		",r}function I(e,t){var r="",i,s;return r+="\n	",s={hash:{},data:t},r+=c((i=n.outlet||e.outlet,i?i.call(e,e["browser-upgrade-banner-view"],s):l.call(e,"outlet",e["browser-upgrade-banner-view"],s)))+"\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f=this,l=n.helperMissing,c=this.escapeExpression,h="function";s+='<div class="global-nav-old">\n<div class="global-nav-shim',u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.show_filter_bar),{hash:{},inverse:f.noop,fn:f.program(1,p,i),data:i});if(u||u===0)s+=u;s+='"></div>\n<div class="global-nav-content ',a={hash:{},inverse:f.noop,fn:f.program(3,d,i),data:i},u=(o=n.isFlipped||t.isFlipped,o?o.call(t,t.flippers,"styleguide-global-nav",a):l.call(t,"isFlipped",t.flippers,"styleguide-global-nav",a));if(u||u===0)s+=u;s+='">\n	<a href="/" class="main-logo" data-track="gnLogoClick" title="',a={hash:{intlName:"global-nav.FLICKR_LOGO_ALT"},data:i},s+=c((o=n.intlMessage||t.intlMessage,o?o.call(t,a):l.call(t,"intlMessage",a)))+'"></a>\n\n	<ul class="nav-menu" role="menubar">\n		',u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.signup_link),{hash:{},inverse:f.noop,fn:f.program(5,v,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.you_menu),{hash:{},inverse:f.noop,fn:f.program(8,g,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.you_link),{hash:{},inverse:f.noop,fn:f.program(17,S,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.contacts_menu),{hash:{},inverse:f.noop,fn:f.program(19,x,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.groups_menu),{hash:{},inverse:f.noop,fn:f.program(21,T,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.explore_menu),{hash:{},inverse:f.noop,fn:f.program(24,C,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.create_link),{hash:{},inverse:f.noop,fn:f.program(27,L,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.create_menu),{hash:{},inverse:f.noop,fn:f.program(29,A,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.upload_link),{hash:{},inverse:f.noop,fn:f.program(31,O,i),data:i});if(u||u===0)s+=u;s+='\n	</ul>\n\n	<ul class="gn-tools">\n		',u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.search_bar),{hash:{},inverse:f.noop,fn:f.program(33,M,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,t.showNotificationsMenu,{hash:{},inverse:f.noop,fn:f.program(41,B,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.account_menu),{hash:{},inverse:f.noop,fn:f.program(43,j,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.signin_link),{hash:{},inverse:f.noop,fn:f.program(45,F,i),data:i});if(u||u===0)s+=u;s+="\n	</ul>\n</div>\n\n",u=n["if"].call(t,t["show-browser-upgrade-banner"],{hash:{},inverse:f.noop,fn:f.program(47,I,i),data:i});if(u||u===0)s+=u;return s+="\n\n",a={hash:{},data:i},s+=c((o=n.outlet||t.outlet,o?o.call(t,t["person-menu-view"],a):l.call(t,"outlet",t["person-menu-view"],a)))+"\n",a={hash:{},data:i},s+=c((o=n.outlet||t.outlet,o?o.call(t,t["group-menu-view"],a):l.call(t,"outlet",t["group-menu-view"],a)))+"\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/global-nav",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-global-nav-restyle",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return" has-filter-bar"}function d(e,t){return"styleguide-global-nav fluid"}function v(e,t){var r="",i,s,o;r+='\n				<li role="menuitem" class="gn-signup">\n					<a data-track="gnSignupClick" class="gn-title ',o={hash:{},inverse:f.noop,fn:f.program(6,m,t),data:t},s=(i=n.isFlipped||e.isFlipped,i?i.call(e,e.flippers,"styleguide-global-nav",o):l.call(e,"isFlipped",e.flippers,"styleguide-global-nav",o));if(s||s===0)r+=s;return r+='" href="/signup">',o={hash:{intlName:"common.SIGN_UP"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+"</a>\n				</li>\n			",r}function m(e,t){return"butt"}function g(e,t){var r="",i,s,o;r+='\n				<li role="menuitem" data-context="you">\n					<a data-track="gnYouMainClick" class="gn-title you" href="'+c((i=(i=e.viewer,i==null||i===!1?i:i.url),typeof i===h?i.apply(e):i))+'" aria-haspopup="true">',o={hash:{intlName:"common.YOU"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a>\n					<ul class="gn-submenu" role="menu">\n						',s=n["if"].call(e,e.showCameraRoll,{hash:{},inverse:f.noop,fn:f.program(9,y,t),data:t});if(s||s===0)r+=s;r+='\n						<li class="menuitem"><a data-track="gnYouPhotostreamClick" href="'+c((i=(i=e.viewer,i==null||i===!1?i:i.url),typeof i===h?i.apply(e):i))+'">',o={hash:{intlName:"common.PHOTOSTREAM"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n						<li class="menuitem"><a data-track="gnYouSetsClick" href="'+c((i=(i=(i=e.viewer,i==null||i===!1?i:i.urls),i==null||i===!1?i:i.albums),typeof i===h?i.apply(e):i))+'">',s=n["if"].call(e,(i=e.elements,i==null||i===!1?i:i.set_not_album),{hash:{},inverse:f.program(13,w,t),fn:f.program(11,b,t),data:t});if(s||s===0)r+=s;r+='</a></li>\n						<li class="menuitem"><a data-track="gnYouFavoritesClick" href="'+c((i=(i=(i=e.viewer,i==null||i===!1?i:i.urls),i==null||i===!1?i:i.favorites),typeof i===h?i.apply(e):i))+'">',o={hash:{intlName:"common.FAVORITES"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n						<li class="menuitem"><a class="server-only-link" data-track="gnYouGroupsClick" href="/groups">',o={hash:{intlName:"global-nav.GROUPS"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n						<li class="menuitem"><a class="server-only-link" data-track="gnYouCreationsClick" href="'+c((i=(i=(i=e.viewer,i==null||i===!1?i:i.urls),i==null||i===!1?i:i.creations),typeof i===h?i.apply(e):i))+'">',o={hash:{intlName:"global-nav.CREATIONS"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n						<li class="menuitem"><a data-track="gnYouPeopleClick" href="'+c((i=(i=(i=e.viewer,i==null||i===!1?i:i.urls),i==null||i===!1?i:i.people),typeof i===h?i.apply(e):i))+'">',o={hash:{intlName:"common.PEOPLE"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n						<li class="menuitem"><a data-track="gnYouRecentActivityClick" href="/activity">',o={hash:{intlName:"global-nav.RECENT_ACTIVITY"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+"</a></li>\n						",s=n["if"].call(e,(i=e.elements,i==null||i===!1?i:i.stats),{hash:{},inverse:f.noop,fn:f.program(15,E,t),data:t});if(s||s===0)r+=s;return r+='\n						<li class="menuitem"><a data-track="gnYouOrganizeClick" href="/photos/organize">',o={hash:{intlName:"global-nav.ORGANIZE"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+"</a></li>\n					</ul>\n				</li>\n			",r}function y(e,t){var r="",i,s;return r+='<li class="menuitem"><a class="server-only-link" data-track="gnYouCameraRollClick" href="'+c((i=(i=(i=e.viewer,i==null||i===!1?i:i.urls),i==null||i===!1?i:i.cameraroll),typeof i===h?i.apply(e):i))+'">',s={hash:{intlName:"global-nav.CAMERAROLL"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+'<span class="label-beta">',s={hash:{intlName:"common.BETA"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</span></a></li>",r}function b(e,t){var r,i;return i={hash:{intlName:"common.SETS"},data:t},c((r=n.intlMessage||e.intlMessage,r?r.call(e,i):l.call(e,"intlMessage",i)))}function w(e,t){var r,i;return i={hash:{intlName:"common.ALBUMS"},data:t},c((r=n.intlMessage||e.intlMessage,r?r.call(e,i):l.call(e,"intlMessage",i)))}function E(e,t){var r="",i,s;return r+='<li class="menuitem"><a data-track="gnYouStatsClick" href="'+c((i=(i=(i=e.viewer,i==null||i===!1?i:i.urls),i==null||i===!1?i:i.stats),typeof i===h?i.apply(e):i))+'">',s={hash:{intlName:"global-nav.STATS"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</a></li>",r}function S(e,t){var r="",i,s;return r+='\n				<li class="toplink">\n					<a data-track="gnYouMainClick" class="gn-link" href="'+c((i=(i=(i=e.viewer,i==null||i===!1?i:i.urls),i==null||i===!1?i:i.photostream),typeof i===h?i.apply(e):i))+'"><span>',s={hash:{intlName:"global-nav.YOUR_PHOTOSTREAM"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</span></a>\n				</li>\n			",r}function x(e,t){var r="",i,s,o;r+='\n				<li role="menuitem" data-context="explore">\n					<a data-track="gnExploreMainClick" class="gn-title explore" href="/explore" aria-haspopup="true">',o={hash:{intlName:"common.EXPLORE"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a>\n					<ul class="gn-submenu" role="menu">\n						<li role="menuitem"><a data-track="gnExploreRecentPhotosClick" href="/explore">',o={hash:{intlName:"global-nav.RECENT_PHOTOS"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n						<li role="menuitem"><a data-track="gnExploreTheCommonsClick" href="/commons">'
,o={hash:{intlName:"global-nav.THE_COMMONS"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n						<li role="menuitem"><a data-track="gnExplore20under20Click" href="/20under20">20under20</a></li>\n						<li role="menuitem"><a data-track="gnExploreGalleriesClick" href="/galleries">',o={hash:{intlName:"global-nav.GALLERIES"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n						<li role="menuitem"><a data-track="gnExploreWorldMapClick" href="/map">',o={hash:{intlName:"global-nav.WORLD_MAP"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n						<li role="menuitem"><a data-track="gnExploreAppGardenClick" href="/services">',o={hash:{intlName:"global-nav.APP_GARDEN"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</a></li>\n						<li role="menuitem"><a data-track="gnExploreCameraFinderClick" href="/cameras">',o={hash:{intlName:"global-nav.CAMERA_FINDER"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+"</a></li>\n						",s=n["if"].call(e,(i=e.elements,i==null||i===!1?i:i.weekly_flickr),{hash:{},inverse:f.noop,fn:f.program(20,T,t),data:t});if(s||s===0)r+=s;return r+='\n						<li role="menuitem"><a data-track="gnExploreFlickrBlogClick" href="https://blog.flickr.net/">',o={hash:{intlName:"global-nav.FLICKR_BLOG"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+"</a></li>\n					</ul>\n				</li>\n			",r}function T(e,t){var r="",i,s;return r+='<li role="menuitem"><a data-track="gnExploreWeeklyFlickrClick" href="/photos/flickr/sets/72157639868074114/">',s={hash:{intlName:"global-nav.THE_WEEKLY_FLICKR"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</a></li>",r}function N(e,t){var r="",i,s;return r+='\n				<li role="menuitem" class="gn-create">\n					<a data-track="gnCreateMainClick" class="gn-title" href="/create">',s={hash:{intlName:"global-nav.CREATE"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</a>\n				</li>\n			",r}function C(e,t){var r="",i,s;return r+='\n				<li role="menuitem" data-context="create">\n					<a data-track="gnCreateMainClick" class="gn-title create" href="/create" aria-haspopup="true">',s={hash:{intlName:"global-nav.CREATE"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+'</a>\n					<ul class="gn-submenu" role="menu">\n						<!-- <li class="menuitem"><a data-track="gnCreateFooClick" href="/foo">',s={hash:{intlName:"global-nav.FOO"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</a></li> -->\n					</ul>\n				</li>\n			",r}function k(e,t){var r="",i,s;return r+='\n				<li role="menuitem" class="gn-upload">\n					<a data-track="gnUploadMain" class="gn-title" href="/upload">',s={hash:{intlName:"global-nav.UPLOAD"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</a>\n				</li>\n			",r}function L(e,t){var r="",i;r+="\n				",i=n["if"].call(e,e.showSmartSearchBar,{hash:{},inverse:f.program(31,O,t),fn:f.program(29,A,t),data:t});if(i||i===0)r+=i;return r+="\n			",r}function A(e,t){var r="",i,s;return r+='\n					<li role="menuitem">\n						',s={hash:{},data:t},r+=c((i=n.outlet||e.outlet,i?i.call(e,e["search-bar-view"],s):l.call(e,"outlet",e["search-bar-view"],s)))+"\n					</li>\n				",r}function O(e,t){var r="",i,s;return r+='\n					<li role="menuitem">\n						<form method="get" role="search">\n							<input type="text" name="text" value="',(i=n.searchValue)?i=i.call(e,{hash:{},data:t}):(i=e.searchValue,i=typeof i===h?i.apply(e):i),r+=c(i)+'" id="gn-search-field" autocomplete="off" aria-label="Search" role="textbox">\n							<input type="submit" data-track="gnSearchSearchIcon" class="search-icon" tabindex="-1" aria-label="',s={hash:{intlName:"global-nav.SEARCH"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+'" role="button">\n						</form>\n					</li>\n				',r}function M(e,t){var r="",i,s;return r+='\n				<li role="menuitem">\n					',s={hash:{},data:t},r+=c((i=n.outlet||e.outlet,i?i.call(e,e["notifications-menu-view"],s):l.call(e,"outlet",e["notifications-menu-view"],s)))+"\n				</li>\n			",r}function _(e,t){var r="",i,s;return r+='\n				<li role="menuitem">\n					',s={hash:{},data:t},r+=c((i=n.outlet||e.outlet,i?i.call(e,e["account-menu-view"],s):l.call(e,"outlet",e["account-menu-view"],s)))+"\n				</li>\n			",r}function D(e,t){var r="",i,s;return r+='\n				<li role="menuitem" class="gn-signin">\n					<a data-track="gnSignin" class="gn-title" href="/signin">',s={hash:{intlName:"global-nav.SIGN_IN"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</a>\n				</li>\n			",r}function P(e,t){var r="",i,s;return r+="\n	",s={hash:{},data:t},r+=c((i=n.outlet||e.outlet,i?i.call(e,e["browser-upgrade-banner-view"],s):l.call(e,"outlet",e["browser-upgrade-banner-view"],s)))+"\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f=this,l=n.helperMissing,c=this.escapeExpression,h="function";s+='<div class="global-nav-restyle">\n<div class="global-nav-shim',u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.show_filter_bar),{hash:{},inverse:f.noop,fn:f.program(1,p,i),data:i});if(u||u===0)s+=u;s+='"></div>\n<div class="global-nav-content ',a={hash:{},inverse:f.noop,fn:f.program(3,d,i),data:i},u=(o=n.isFlipped||t.isFlipped,o?o.call(t,t.flippers,"styleguide-global-nav",a):l.call(t,"isFlipped",t.flippers,"styleguide-global-nav",a));if(u||u===0)s+=u;s+='">\n	<div class="global-nav-container fluid-centered">\n		<a href="/" class="main-logo" data-track="gnLogoClick" title="',a={hash:{intlName:"global-nav.FLICKR_LOGO_ALT"},data:i},s+=c((o=n.intlMessage||t.intlMessage,o?o.call(t,a):l.call(t,"intlMessage",a)))+'"></a>\n\n		<ul class="nav-menu" role="menubar">\n			'
,u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.signup_link),{hash:{},inverse:f.noop,fn:f.program(5,v,i),data:i});if(u||u===0)s+=u;s+="\n\n			",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.you_menu),{hash:{},inverse:f.noop,fn:f.program(8,g,i),data:i});if(u||u===0)s+=u;s+="\n\n			",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.you_link),{hash:{},inverse:f.noop,fn:f.program(17,S,i),data:i});if(u||u===0)s+=u;s+="\n\n			",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.explore_menu),{hash:{},inverse:f.noop,fn:f.program(19,x,i),data:i});if(u||u===0)s+=u;s+="\n\n			",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.create_link),{hash:{},inverse:f.noop,fn:f.program(22,N,i),data:i});if(u||u===0)s+=u;s+="\n\n			",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.create_menu),{hash:{},inverse:f.noop,fn:f.program(24,C,i),data:i});if(u||u===0)s+=u;s+='\n\n		</ul>\n\n		<ul class="gn-tools">\n			',u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.upload_link),{hash:{},inverse:f.noop,fn:f.program(26,k,i),data:i});if(u||u===0)s+=u;s+="\n			",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.search_bar),{hash:{},inverse:f.noop,fn:f.program(28,L,i),data:i});if(u||u===0)s+=u;s+="\n\n			",u=n["if"].call(t,t.showNotificationsMenu,{hash:{},inverse:f.noop,fn:f.program(33,M,i),data:i});if(u||u===0)s+=u;s+="\n\n			",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.account_menu),{hash:{},inverse:f.noop,fn:f.program(35,_,i),data:i});if(u||u===0)s+=u;s+="\n\n			",u=n["if"].call(t,(o=t.elements,o==null||o===!1?o:o.signin_link),{hash:{},inverse:f.noop,fn:f.program(37,D,i),data:i});if(u||u===0)s+=u;s+="\n		</ul>\n	</div>\n</div>\n\n",u=n["if"].call(t,t["show-browser-upgrade-banner"],{hash:{},inverse:f.noop,fn:f.program(39,P,i),data:i});if(u||u===0)s+=u;return s+="\n\n",a={hash:{},data:i},s+=c((o=n.outlet||t.outlet,o?o.call(t,t["person-menu-view"],a):l.call(t,"outlet",t["person-menu-view"],a)))+"\n",a={hash:{},data:i},s+=c((o=n.outlet||t.outlet,o?o.call(t,t["group-menu-view"],a):l.call(t,"outlet",t["group-menu-view"],a)))+"\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/global-nav-restyle",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-helper",function(e){function v(e){return!e[n.userId]&&!e[n.groupId]&&!e[n.tags]&&!e[n.text]&&!e[n.license]&&!e[n.faves]&&!e[n.contacts]&&!e[n.getty]&&!e[n.commons]&&!e[n.minTakenDate]&&!e[n.maxTakenDate]&&!e[n.minUploadDate]&&!e[n.maxUploadDate]&&!e[n.hasGeo]&&!e[n.boundingBox]&&!e[n.woeId]&&!e[n.camera]&&!e[n.minExposure]&&!e[n.maxExposure]&&!e[n.minAperture]&&!e[n.maxAperture]&&!e[n.minFocalLength]&&!e[n.maxFocalLength]&&!e[n.foursquareWoeId]&&!e[n.foursquareVenueId]}function m(e,t){var n;for(n in l){if(!t&&n===e)return l[n];if(t&&l[n]===e)return n}}function g(t){var r={nsid_or_path_alias:"userId",group_id:"groupId",set_id:"setId",page_number:"page",tag_list:"tags",location:"text",slideshow_start_id:"slideshowStartId"},i,s={};for(i in r)t[i]&&(s[n[r[i]]]=t[i]);return s[n.groupId]&&!e.TypeValidator.matches.nsid(s[n.groupId])&&(s[n.groupPathAlias]=s[n.groupId],delete s[n.groupId]),s}function y(e,t){var n={},i=null,u=t.getViewer();e=e||{},e.q&&(n[o.username]=e.q);if(e.s)switch(e.s){case"age":n[o.sort]=r.oldestJoined;break;case"pho":n[o.sort]=r.mostPhotos}e.see&&e.see.toString().toLowerCase()==="all"&&u.signedIn&&(n[o.userId]=u.nsid),e.m&&(e.m.toString().toLowerCase()==="extras",e.m.toString().toLowerCase()==="names");for(i in e)s.indexOf(i)===-1&&(n[i]=e[i]);return n}function b(e,t){var n={},i=null,s;e=e||{},s=e.m&&e.m.toString().toLowerCase()==="discuss",e.q&&(n[a.text]=e.q),s;if(e.s)switch(e.s){case"act":s?n[a.sort]=r.discussionActivity:n[a.sort]=r.activity;break;case"siz":n[a.sort]=r.size;break;case"age":n[a.sort]=r.newest;break;case"rep":}for(i in e)u.indexOf(i)===-1&&(n[i]=e[i]);return n}function w(i,s){var o={},u,a,f=s.getViewer(),c=i.l,h=i.s,p=i.w,d=i.d&&i.d.split("-"),v=i.m,m=i.q,g;i.q&&(o[n.text]=i.q),typeof i["ss"]!="undefined"&&(o[n.safeSearch]=parseInt(i.ss,10)+1),typeof i["ct"]!="undefined"&&(o[n.contentType]=parseInt(i.ct,10)+1),typeof i["mt"]!="undefined"&&(o[n.mediaType]=i.mt),i.b&&(o[n.boundingBox]=i.b),i.a&&(o[n.accuracy]=i.a),i.e&&(o[n.woeId]=i.e),i.g&&(o[n.groupId]=i.g),i.cm&&(o[n.camera]=i.cm),typeof i["xel"]!="undefined"&&(o[n.minExposure]=i.xel),typeof i["xeh"]!="undefined"&&(o[n.maxExposure]=i.xeh),typeof i["xal"]!="undefined"&&(o[n.minAperture]=i.xal),typeof i["xah"]!="undefined"&&(o[n.maxAperture]=i.xah),typeof i["xfl"]!="undefined"&&(o[n.minFocalLength]=i.xfl),typeof i["xfh"]!="undefined"&&(o[n.maxFocalLength]=i.xfh),i.eui&&(o[n.excludeUserId]=i.eui);if(typeof c!="undefined")switch(c){case"cc":case"comm":case"deriv":case"commderiv":o[n.license]=l[c];break;default:a=parseInt(c,10),a>=0&&a<=8&&(o[n.license]=a)}if(h)switch(h){case"rec":o[n.sort]=r.recent;break;case"rel":o[n.sort]=r.relevant;break;case"int":o[n.sort]=r.interesting;break;default:}i.hd&&(o[n.media]="hdvideo");if(p)if(p.indexOf("faves")!==-1)g=p.split("-"),o[n.faves]=1,g.length>1?o[n.userId]=g[1]:f.signedIn&&(o[n.userId]=f.nsid);else if(e.TypeValidator.matches.nsid(p))v==="pool"?o[n.groupId]=p:o[n.userId]=p;else switch(p){case"contacts":o[n.contacts]="all";break;case"ff":o[n.contacts]="ff";break;case"getty":o[n.getty]="true";break;case"commons":o[n.commons]="true";break;case"usg":o[n.license]=8;break;case"all":default:}if(d)switch(d[0]){case"taken":d[1]&&(o[n.minTakenDate]=e.flutil.parseYYYYMMDDDatestamp(d[1])/1e3),d[2]&&(o[n.maxTakenDate]=e.flutil.parseYYYYMMDDDatestamp(d[2])/1e3);break;case"posted":d[1]&&(o[n.minUploadDate]=e.flutil.parseYYYYMMDDDatestamp(d[1])/1e3),d[2]&&(o[n.maxUploadDate]=e.flutil.parseYYYYMMDDDatestamp(d[2])/1e3);break;default:}if(v&&m)switch(v){case"tags":o=e.merge(o,this._processTags(m)),delete o[n.text];break;default:}for(u in i)t.indexOf(u)===-1&&(o[u]=i[u]);return o}function E(e){var t={},r=e[n.userId];return e[n.text]?t.q=e[n.text]:e[n.tags]&&(t.q=e[n.tags]),e[n.faves]?r?t.w="faves-"+r:t.w="faves":r?t.w=r:e[n.contacts]==="all"?t.w="contacts":e[n.contacts]==="ff"?t.w="ff":e[n.getty]==="true"?t.w="getty":e[n.commons]==="true"?t.w="commons":parseInt(e[n.license],10)===8&&(t.w="usg"),e[n.license]&&(t.l=m(e[n.license],!0)),t}function S(e,t){e[n.sort]||(e[n.sort]=r.relevant),e[n.license]&&(e[n.license]===l.all||e[n.license]==="")&&delete e[n.license]}function x(e){e[a.sort]||(e[a.sort]=r.relevant),typeof e[a.filterInactive]=="undefined"&&(e[a.filterInactive]="1")}function T(e){}function N(e,t){for(var n in e)t.indexOf(n)===-1&&delete e[n]}function C(e){this.clearParams(e,h)}function k(e){this.clearParams(e,c)}function L(t){var n=e.clone(t)||{};return delete n.page,delete n.method,delete n.extras,e.QueryString.stringify(n)}function A(t){var r=t[n.groupId],i=t[n.tags],s=t[n.text];YUI.Env.isServer&&(r&&(t[n.groupId]=e.flutil.unescape(r)),i&&(t[n.tags]=e.flutil.unescape(i)),s&&(t[n.text]=e.flutil.unescape(s)))}function O(e){var t=0;return e.photos&&!e.screenshots&&!e.other?t=1:!e.photos&&e.screenshots&&!e.other?t=2:!e.photos&&!e.screenshots&&e.other?t=3:e.photos&&e.screenshots&&!e.other?t=4:!e.photos&&e.screenshots&&e.other?t=5:e.photos&&!e.screenshots&&e.other?t=6:e.photos&&e.screenshots&&e.other&&(t=7),t}function M(e){var t={},n=parseInt(e,10);switch(n){case 1:t.photos=!0;break;case 2:t.screenshots=!0;break;case 3:t.other=!0;break;case 4:t.photos=!0,t.screenshots=!0;break;case 5:t.other=!0,t.screenshots=!0;break;case 6:t.photos=!0,t.other=!0;break;default:t.photos=!0,t.screenshots=!0,t.other=!0}return t}function _(t){var n=e.AttributeHelpers.coerceInteger(t);return e.AttributeHelpers.coerceString(n+1)}function D(t,r){var i=r.getViewer(),s;return t[n.userId]?i&&i.signedIn&&i.nsid===t[n.userId]?e.Promise.resolve({intlName:"search.YOUR_PHOTOS"}):(e.TypeValidator.matches.nsid(t[n.userId])?s=t[n.userId]:s={pathAlias:t[n.userId]},r.getModel("person-models",s).then(function(e){var r;return t[n.faves]?r="search.FAVES_POSSESSIVE":r="search.PHOTOS_POSSESSIVE",{intlName:r,name:e.getValue("username")}})):t[n.contacts]?e.Promise.resolve({intlName:"search.FROM_PEOPLE_YOU_FOLLOW"}):t[n.groupId]||t[n.groupPathAlias]?(t[n.groupId]?s={id:t[n.groupId]}:s={pathAlias:t[n.groupPathAlias]}
,r.getModel("group-info-models",s).then(function(e){return{intlName:"search.IN_GROUP_POOL",name:e.getValue("group").getValue("title")}})):t[n.faves]?e.Promise.resolve({intlName:"search.VIEWER_FAVES"}):e.Promise.resolve({intlName:"search.EVERYONES_PHOTOS"})}function P(t,n,r){var i,s,o=this;return t===n?!0:r<=0?!1:(r=r||1,!e.Lang.isObject(t)||!e.Lang.isObject(n)?!1:(i=Object.keys(t),s=Object.keys(n),i.length!==s.length?!1:i.every(function(e){return o.objectsAreEquivalentToDepth(t[e],n[e],r-1)})))}function H(e){var t={},r=/(["'])(\\?.)*?\1/g,i=/[,\+\s]/,s=/^([,\+]|AND|OR)$/,o=/[\+\s]OR[\+\s]/,u,a,f,l;return u=e.match(r)||[],a=e.replace(r,""),f=a.split(i),f=f.map(function(e){return e.trim()}).filter(function(e){return e&&!s.test(e)}),l=u.concat(f),t[n.tags]=l.join(","),o.test(e)?(t[n.tagMode]="any",l.length=Math.min(l.length,11)):t[n.tagMode]="all",t}var t=["q","ss","ct","mt","l","s","w","d","m","hd","b","a","g","e","cm","xel","xeh","xal","xah","xfl","xfh","eui"],n={userId:"user_id",groupId:"group_id",groupPathAlias:"group_path_alias",setId:"set_id",page:"page",text:"text",tags:"tags",tagMode:"tag_mode",sort:"sort",safeSearch:"safe_search",contentType:"content_type",mediaType:"media",license:"license",faves:"faves",contacts:"contacts",getty:"is_getty",commons:"is_commons",minTakenDate:"min_taken_date",maxTakenDate:"max_taken_date",minUploadDate:"min_upload_date",maxUploadDate:"max_upload_date",hasGeo:"has_geo",boundingBox:"bbox",accuracy:"accuracy",woeId:"woe_id",camera:"camera",minExposure:"exif_min_exposure",maxExposure:"exif_max_exposure",minAperture:"exif_min_aperture",maxAperture:"exif_max_aperture",minFocalLength:"exif_min_focallen",maxFocalLength:"exif_max_focallen",excludeUserId:"exclude_user_id",foursquareWoeId:"foursquare_woeid",foursquareVenueId:"foursquare_venueid",slideshowStartId:"jump_to",height:"height",width:"width",dimensionSearchMode:"dimension_search_mode",orientation:"orientation",colorCodes:"color_codes"},r={relevant:"relevance",recent:"date-posted-desc",interesting:"interestingness-desc",name:"exact-name-match-first",activity:"most-activity",size:"most-members",oldest:"oldest-first",newest:"recent-first",oldestJoined:"age",mostPhotos:"pho"},i={portrait:"portrait",square:"square",landscape:"landscape",panorama:"panorama"},s=["s","q","see","m"],o={username:"username",userId:"user_id",sort:"sort"},u=["q","s","m"],a={text:"text",sort:"sort",safeSearch:"safe_search",subscriptionTypes:"subscription_types",filterInactive:"filter_inactive_groups"},f={safe:1,all:2,eighteenPlusOnly:3},l={all:"0,1,2,3,4,5,6,7,8",cc:"1,2,3,4,5,6",deriv:"1,2,4,5",comm:"4,5,6",commderiv:"4,5"},c=[n.userId,n.groupId,n.faves,n.contacts,n.commons],h=[n.userId,n.groupId,n.faves,n.contacts,n.safeSearch,n.sort,n.license,n.tags,n.text],p=20,d=50;e.SearchHelper={API:n,PEOPLE_SEARCH_API:o,GROUPS_SEARCH_API:a,GROUPS_SAFE_SEARCH_SETTINGS:f,API_SORT_OPTIONS:r,API_ORIENTATION_OPTIONS:i,LICENSE_TYPE:l,PREFETCH_PAGE_SIZE:p,FETCH_PAGE_SIZE:d,SEARCH_SCOPE_PARAMS:c,decodeContentType:M,encodeContentType:O,isParameterlessSearch:v,mapRouteParamsToAPI:g,convertLicenseTypeValue:m,mapClassicSearchToAPI:w,mapClassicPeopleSearchToAPI:y,mapClassicGroupSearchToApi:b,mapAPIParamsToAdvancedSearchQuery:E,deriveScopeTitle:D,addParamDefaults:S,addGroupsParamDefaults:x,addPeopleParamDefaults:T,clearParams:N,clearAdvancedSearchParams:C,clearParamsExceptSearchScope:k,generateQueryString:L,convertSafeSearchPrefsToApi:_,unescapeParameters:A,objectsAreEquivalentToDepth:P,_processTags:H}},"@VERSION@",{requires:["type-validator","flutil"]});
YUI.add("search-url",function(e){function i(e){return typeof e=="number"?e.toString():typeof e=="boolean"?e?"1":"0":typeof e=="string"?e:undefined}var t,n,r=/^bw|blackandwhite$/;YUI.Env.isServer?t=require("querystring").stringify:t=e.QueryString.stringify,n=function(t,r,s){var o,u,a,f,l;this.appContext=r,typeof t=="string"?(l=t.split("?"),s?this.searchType=s:(u=l[0].split("/"),u[0].indexOf("http")!==-1?a=3:a=1,f="/"+u.slice(a).join("/"),this.searchType=this.getSearchTypeFromPathname(f)),l=l.length>1?l[1]:"",this.params=l?e.QueryString.parse(l):{}):(this.params=e.merge(t),this.searchType=s);for(o in this.params)this.params.hasOwnProperty(o)&&(this.params[o]=i(this.params[o]));this.params.color_codes&&(this.colors=this.params.color_codes.toString().split(",")),this.searchType||this.setSearchType(n.searchTypes.UNDEFINED)},n.prototype.setSearchType=function(t){var n=this.getSearchTerm();return this.searchType=t,this.params=this.validateParams(this.params,this.searchType),this.params=e.merge(this.getDefaultParams(this.searchType),this.params),n&&this.setSearchTerm(n),this},n.prototype.getSearchTypeFromPathname=function(e){e=e||this.pathname,e=e.toLowerCase(),e=e.split("/").join("");switch(e){case"searchpeople":return n.searchTypes.PEOPLE;case"searchgroups":return n.searchTypes.GROUPS;case"search":default:return n.searchTypes.PHOTOS}},n.prototype.getPathname=function(){var e="/search/";switch(this.searchType){case n.searchTypes.PEOPLE:e+="people/";break;case n.searchTypes.GROUPS:e+="groups/";break;case n.searchTypes.PHOTOS:default:}return e},n.prototype.validateParams=function(t,r){var i,s={},o,u;t=e.merge(t);switch(r){case n.searchTypes.PEOPLE:i=e.merge(e.SearchHelper.PEOPLE_SEARCH_API),i.text="text";break;case n.searchTypes.GROUPS:i=e.merge(e.SearchHelper.GROUPS_SEARCH_API);break;case n.searchTypes.PHOTOS:i=e.merge(e.SearchHelper.API),i.advanced="advanced",i.view_all="view_all",i.album_search="album_search";break;case n.searchTypes.UNDEFINED:default:return t}if(i)for(o in i)u=i[o],typeof t[u]!="undefined"&&(s[u]=t[u]);return s},n.prototype.getDefaultParams=function(t){var r={};switch(t){case n.searchTypes.PEOPLE:e.SearchHelper.addPeopleParamDefaults(r);break;case n.searchTypes.GROUPS:e.SearchHelper.addGroupsParamDefaults(r);break;case n.searchTypes.PHOTOS:e.SearchHelper.addParamDefaults(r);break;case n.searchTypes.UNDEFINED:default:}return r},n.prototype.getAPIParams=function(){return e.merge(this.params)},n.prototype.getAPIParam=function(e){return this.params[e]},n.prototype.setAPIParam=function(e,t){return this.params[e]=i(t),this},n.prototype.removeAPIParam=function(e){return delete this.params[e],this},n.prototype.removeAllAPIParams=function(){return this.params={},this},n.prototype.getSearchTerm=function(){var e=this.params[this.getSearchTermKey(this.searchType)];return e||(e=this.params.tags),e||""},n.prototype.setSearchTerm=function(t){var n=this.getSearchTermKey(this.searchType);return delete this.params[e.SearchHelper.PEOPLE_SEARCH_API.username],delete this.params[e.SearchHelper.GROUPS_SEARCH_API.text],delete this.params[e.SearchHelper.API.text],this.params[n]=t,this},n.prototype.getSearchTermKey=function(t){switch(t){case n.searchTypes.PEOPLE:return e.SearchHelper.PEOPLE_SEARCH_API.username;case n.searchTypes.GROUPS:return e.SearchHelper.GROUPS_SEARCH_API.text;case n.searchTypes.PHOTOS:default:return e.SearchHelper.API.text}},n.prototype.removeScope=function(){return e.SearchHelper.SEARCH_SCOPE_PARAMS.forEach(function(e){this.removeAPIParam(e)}.bind(this)),this},n.prototype.resetToUnified=function(){return this.removeAPIParam("view_all"),this.removeAPIParam("contacts"),this.removeAPIParam("user_id"),this},n.prototype.createNewSearch=function(e){this.setSearchTerm(e);if(this.searchType===n.searchTypes.UNDEFINED||this.searchType===n.searchTypes.PHOTOS)this.removeScope(),this.resetToUnified();return this},n.prototype.getURL=function(){var e=this.getId(),t=this.getPathname();return e===n.EMPTY_SEARCH_ID?t:t+"?"+e},n.prototype.getId=function(){var r={},i,s=e.SearchHelper.API;for(i in this.params)s[i]?r[s[i]]=this.params[i]:r[i]=this.params[i];return t(r)||n.EMPTY_SEARCH_ID},n.prototype.clone=function(){var e=new n(this.params,this.appContext,this.searchType);return e},n.prototype.setMedia=function(t,n){var r;t||(t=!1),n||(n=!1),t&&n?r="all":t?r="photos":r="videos",this.setAPIParam(e.SearchHelper.API.mediaType,r)},n.prototype._syncColors=function(){this.colors&&this.colors.length>0?this.params.color_codes=this.colors.join(","):this.removeAPIParam("color_codes")},n.prototype.addColorCode=function(e){if(e&&e.match(r)){this.clearColorCodes(),this.colors=["bw"],this._syncColors();return}this.colors&&this.colors.indexOf("bw")!==-1&&(this.colors=[]),this.colors||(this.colors=[]),this.colors.indexOf(e)===-1&&(this.colors.push(e),this._syncColors())},n.prototype.removeColorCode=function(e){var t;this.colors&&(t=this.colors.indexOf(e),t!==-1&&(this.colors.splice(t,1),this._syncColors()))},n.prototype.clearColorCodes=function(){this.colors=[],this._syncColors()},n.searchTypes={UNDEFINED:0,PHOTOS:1,PEOPLE:2,GROUPS:3},n.EMPTY_SEARCH_ID="-1",e.SearchUrl=n},"@VERSION@",{requires:["search-helper","querystring-parse-simple","querystring-stringify-simple"]});
